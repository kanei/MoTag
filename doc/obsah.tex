%=========================================================================
% (c) Michal Bidlo, Bohuslav Køena, 2008

\chapter{Úvod}
\label{chap:uvod}
Tato práce pojednává o vyu¾ití existujících øe¹ení, vyu¾ívajících algoritmù automatického poèítaèového uèení (Conditional Random Fields s vyu¾ítím algoritmù Limited-memory BFGS a Stochastic Gradient Descent) a porovnání výsledkù s existujícími øe¹eními, kterými v na¹em pøípadì je program Morèe vyvíjený na pra¾ské Univerzitì Karlovì, pou¾ívající Hidden Markov Model. Z existujících øe¹ení poté byly vybrány programy CRF++ a CrfSuite.

V dokumentu bude nejdøíve popsáno samotné znaèkování èe¹tiny a jeho pravidla, a potí¾e, které jsou s ním spojeny v porovnání s jinými, jednodu¹¹ími jazyky. Dále budou rozebrány matematické modely a algoritmy, které jsou pou¾ity pøi procesu uèení. K celému procesu bylo potøeba vytvoøit nìkolik nástrojù, buï konvertujících vstupní data pro jednotlivé programy, nebo ulehèujících vlastní proces testování. Mezi tyto patøí skritpy napsané v jazyce Python a bash a informaèní systém, starající se o správu bì¾ících a dokonèených testù a informací o nich, implementovaný za pomocí PHP, SQL a HTML, postavený na open-source CMS systému Drupal. Ve¹kerý kód byl spravován pomocí verzovacího systému GIT a je veøejnì dostupný na internetu\cite{zdrojak}.

Nejdùle¾itìj¹í èástí dokumentù pak jsou výsledky testování, zpracovávaného na ¹kolních strojích pøes vzdálený pøistup. Testy byly provedeny z mnoha rùzných úhlù pohledu na efektivitu a jsou doplnìny o tabulky a grafy. 

\section{Termíny}
\label{sec:terminy}
Pro dal¹í text definujeme následující termíny:
\begin{itemize}
	\item \textbf{Znaèka} -- \textit{angl. Label} -- øetìzec popisující vlastnost
 		daného prvku, v na¹em pøípadì urèení mluvnických tøíd.
	\item \textbf{Rys} -- \textit{angl. Feature} -- prvek pou¾ívaný pøi trénování,
		specifikující vlastnost daného prvku ve vstupních datech.
	\item \textbf{Vlastnost} -- \textit{angl. Atribut} -- pravidlo pro generování
		jednotlivých rysù 
	\item \textbf{Lemma} -- základní podoba slova (slovníkový tvar)
	\item \textbf{Delta} -- rozdíl v celkové pravdìpodobnosti mezi dvoumi po soubì jdoucími iteracemi
\end{itemize}
\chapter{Znaèkování èeského jazyka}
\label{chap:znackovani}
\section{Proè znaèkovat jazyk}
V èeském jazyce má mnoho slov tzv. homonymní tvar -- jedno slovo mù¾e být v rùzných pøípadech naprosto odli¹ným slovním druhem, nebo mít odli¹né urèení slovních kategorií. Pøi strojové analýze textu, pøekladech apod. je proto dùle¾ité, abychom byli schopni tyto kategorie rozli¹ovat a pøiøazovat jednotlivým slovùm jejich správnou znaèku.

\section{Co je to znaèkování}
Proces, pøi kterém je slovu, pøiøazena  znaèka obsahující jeho popis z mluvnického hlediska. Tento proces je èasto rozdìlen na nìkolik krokù, kdy slovu nejdøíve pøiøadíme v¹echny mo¾né znaèky a poté teprve vybereme tu správnou. V této práci se budeme zabývat pouze druhým krokem a v¹echna vstupní data proto ji¾ budou mít nastavena mno¾inu v¹ech znaèek, pøipadajících v úvahu. 

\section{Kategorie popisované znaèkou v èeském jazyce}
Ka¾dé slovo èeského jazyka má mnoho kategorií, do kterých mù¾e být zaøazeno -- od slovního druhu po slovesný vid. V poèítaèovém zpracování jazyka lze pou¾ít nìkolika rùzných pøístupù k ulo¾ení tìchto informací. V na¹em pøípadì bude struktura znaèek odpovídat systému\cite{znacky} pou¾ívanému na pra¾ské Univerzitì Karlovì. Tento systém se skládá ze 16 pozic (viz. tabulka ~\ref{tab:PopisZnacek}).
\begin{center}
	\begin{tabular}{|c|l|}
		\hline
		Pozice & Popis \\
		\hline
		1 & Slovní druh \\
		2 & Detail slovního druhu \\
		3 & Jmenný rod \\
		4 & Èíslo \\
		5 & Pád \\
		6 & Pøivlastòovací rod \\
		7 & Pøivlastòovací èíslo \\
		8 & Osoba \\
		9 & Èas \\
		10 & Stupeò \\
		11 & Negace \\
		12 & Aktívum/pasívum \\	
		13 & Nepou¾ito \\
		14 & Nepou¾ito \\
		15 & Varianta, stylový pøíznak a pod. \\
		16 & Slovesný vid \\
		\hline
	\end{tabular}
	\captionof{table}{Popis jednotlivých pozic morfologické znaèky}
	\label{tab:PopisZnacek}
\end{center}

\section{Problémy pøi znaèkování}
Zatímco v angliètinì pøi pouhém oznaèkování slov s jednoznaènou znaèkou dosáhneme úspì¹nosti kolem 90\%, v èeském jazyce je situace mnohem slo¾itìj¹í. Kvùli vý¹e zmínìné homonymii a mno¾ství kategorii, do kterých v èeském jazyce slova mù¾eme zaøadit, bychom se v na¹em pøípadì k 90\% urèitì ani nepøiblí¾ili. V angliètinì se proto také pou¾ívá pouze tøí-pozicová znaèka, která velmi ulehèuje práci ve¹kerým automatickým programùm. Pøi takto nízkém poètu je také velmi nízká pamì»ová nároènost a poèet mo¾ných pøechodù není tak vysoký. Naproti tomu v èe¹tinì je kvùli 16 pozicím mo¾no získat celkový poèet znaèek v øádu tisícù a tím se neúmìrnì zvy¹uje èasová i pamì»ová nároènost celého procesu znaèkování. Z tohoto dùvodu jsem se pokou¹el tuto nároènost sní¾it vypu¹tìním ménì dùle¾itých kategorií a tím sní¾it celkový poèet variant k èíslu nepøevy¹ujícímu jeden tisíc. Nároènost na procesorový èas se tím razantnì sní¾ila a dala mi tak ¹anci otestovat mnohem vìt¹í mno¾ství kombinací rysù a nastavení programù.
\section{Data}
K trénování a následné evaluaci výsledkù máme k dispozici okolo 77 000 vìt. Data jsou získána z korpusu PDT 2.0 a ulo¾ena ve formátu dat CSTS\cite{csts}. Pomocí skriptù napsaných pøevá¾nì v jazyce python jsou poté tato data pøevedena do formátu kompatibilního s pou¾itými programy.
\section{Existující øe¹ení pro znaèkování èeského jazyka}
Pro porovnání výsledkù tohoto projektu byl pou¾it program Morèe\cite{Morce} vytvoøený na Ústavu formální a aplikované lingvistiky na Univerzitì Karlovì v Praze. K trénování je vyu¾íván Skrytý Markovùv Model s pou¾itím Prùmìrovaného perceptronu. Vstupními daty je korpus PDT 2.0 s údaji ve formátu CSTS. Podle dostupných údajù program dosahuje úspì¹nosti od 95 do 96 procent je tudí¾ nejpøesnìj¹ím znaèkovacím programem pro zpracování èeského jazyka. Z dùvodu pou¾ití stejných dat tedy nebude problém porovnat koneènou úspì¹nost námi pou¾ité implementace s úspì¹ností programu Morèe.

\chapter{Pou¾ité algoritmy}
\label{chap:algoritmy}

Pro odli¹ení od existujících øe¹ení byl vybrán algoritmus Conditional Random Fields (Podmínìná náhodná pole), roz¹iøující Hidden Markov Model a tím nabízející vý¹¹í úèinnost na vstupních datech. Pro lep¹í pochopení CRF je potøeba nejdøíve porozumìt zpùsobu, jakým pracuje algoritmus HMM. V mnoha existujících øe¹eních se poté pro urèení parametrù pou¾ívají rùzné algoritmy od Viterbi algorithm, pou¾ívaného ji¾ od 60. let minulého století, pøes Forward-Backward algorithm, jeho modifikaci Baum-Welch algorithm a¾ po \uv{nejmodernìj¹í} zástupce, kterými jsou Low Memory BFGS a Stochastic Gradient Descent, poskytující nejlep¹í výsledky, nebo vysoké sní¾ení pamì»ové a èasové nároènosti.

Celý proces poté probíhá za tzv. Supervised Learning (uèení se pod dohledem), kdy programu nejdøíve pøedlo¾íme ji¾ správnì oznaèená data a necháme jej, aby se pomocí jednoho z vý¹e zmínìných algoritmù nauèil správné parametry modelu (CRF nebo HMM). Takto získaný model poté aplikujeme na men¹í skupinu dat, pomocí které poté urèíme koneènou úspì¹nost celého procesu.

\section{Hiden Markov Model (HMM)}
\label{sec:hmm}
Skrytý Markovský model (viz.\cite{Kovar}), pojmenovaný po ruském matematikovi Andreyi Markovi, oznaèuje statistický model urèený pro popis posloupnosti obsahující Markovské stavy. Tìmi máme na mysli takový stav, pro nì¾ je dùle¾itá pouze blízká minulost (v na¹em pøípadì pouze nìkolik pøedchozích stavù -- znaèek) a vzdálená minulost je zanedbána. Ve zpracování jazyka se èasto omezuje zpracování pouze na dvì pøedchozí znaèky.

Zatímco u klasického Markovského modelu známe posloupnost vstupních hodnot, v na¹em pøípadì známe pouze posloupnost hodnot výsledných (slovních tvarù). V ka¾dém kroku je poté ulo¾ena hodnota pravdìpodobnosti pøechodu do mo¾ných následujících stavù a hodnota pravdìpodobnosti vygenerování urèitého výstupu (znaèky). Celý proces je zachycen na obrázku ~\ref{fig:GrafHMM}.

\begin{figure}[ht!]
	\centering
		\includegraphics[width=\textwidth]{fig/HMM}
		\caption{Graf mo¾ných pøechodù a výstupù modelu}
		\label{fig:GrafHMM}
\end{figure}

Z tohoto ukázkového pøíkladu mù¾eme vyvodit, ¾e pøi posloupnosti pozorovaných tvarù ètverec, kosoètverec, kruh, trojúhelník, mù¾e \uv{skrytá} vstupní posloupnost mít jednu z podob zobrazených v tabulce ~\ref{tab:HMMPrechody}.
\begin{figure}
	\begin{center}
		\begin{tabular}{|c c c c|}
			\hline
			1 & 2 & 1 & 1 \\
			\hline
			1 & 2 & 1 & 2 \\ 
			\hline
			1 & 2 & 2 & 1 \\ 
			\hline
			1 & 2 & 2 & 3 \\
			\hline
		\end{tabular}
		\captionof{table}{Mo¾né pøechody mezi skrytými stavy modelu}
		\label{tab:HMMPrechody}
	\end{center}
\end{figure}
Nejpravdìpodobnìj¹í z nich bychom byli schopni urèit pomocí ohodnocení jednotlivých pøechodù. 

V na¹em pøípadì bychom pak pøi trénování, kdy známe jak vstupní, tak výstupní posloupnost, museli urèitým zpùsobem vypoèítat hodnoty na jednotlivých pøechodech. K tomu mù¾eme pou¾ít jeden k tomu urèených algoritmù -- Viterbiho algoritmus, Forward-Backward algoritmus, nebo Baum-Welch algoritmus. S jejich pomocí jsme poté po nìkolika iteracích schopni získat hodnoty pro ideální prùchod pøi neznámé posloupnosti.

I kdy¾ není HMM implementováno v ¾ádném z vyu¾itých programù, poskytuje základ pro pochopení algoritmu CRF.

\section{Conditional Random Fields (CRF)}
\label{sec:crf}
CRF mù¾eme popsat jako bezsmìrový grafický pravdìpodobnostní model (undirected probabilistic graphical model), ve kterém ka¾dý uzel (v na¹em pøípadì slovo) popisuje náhodnou promìnnou. CRF mù¾e také být vyjádøen jako model s koneèným poètem stavù a nenormalizovanými pravdìpodobnostmi pøechodù. V porovnání k HMM nemá jasnì dané hodnoty pøechodù mezi stavy a disponuje mo¾ností mnohonásobných funkcí, generujících rysy. Pøiná¹í také lep¹í výsledky ve zpracování dat se závislostmi vy¹¹ího øádu, které vìt¹inou lépe odpovídají reálnému modelu. Na rozdíl od generativních modelù také, jako¾to pravdìpodobnostní (conditional) model nemusí zkoumat v¹echny mo¾né sekvence pozorovaných prvkù (observations). Pro urèení parametrù tohoto modelu je v souèasné dobì nejvíce doporuèován algoritmus L-BFGS (Low-Memory BFGS), který poskytuje nejkvalitnìj¹í výsledky.

\subsection{Label Bias problém}
Problém ¹patného vyva¾ování znaèek (viz.\cite{Lafferty}) spoèívá v pøesunu pravdìpodobnostní hodnoty na dal¹í pozici v pøípadì pouze jediného pøechodu za ignorování pozorovaného prvku. Jak je ilustrováno na obrázku ~\ref{fig:GrafLabelBias}, v pøípadì vstupní posloupnosti písmen t,i,k se v prvním kroku neumíme rozhodnout a vstupujeme do stavù 1 a 4 se stejnou pravdìpodobností. Nyní, i kdy¾ na vstupu je písmeno i, nemáme jinou mo¾nost, ne¾ pokraèovat do stavù 2, pøípadnì 5 za ignorování pozorovaného písmena. V pøípadì, ¾e by v trénovacích datech tedy pøevládal øetìzec \uv{tik} nad øetìzcem \uv{tak}, byly by oba tyto øetìzce v¾dy urèeny jako \uv{tik}. Toto je vy¾e¹eno algoritmem CRF pomocí ohodnocení pøechodù mezi stavy, kdy mù¾eme podle aktuálního pozorovaného prvku buï sní¾it, nebo zvý¹it koneènou pravdìpodobnost dané posloupnosti.

\begin{figure}[ht!]
	\centering
		\includegraphics[width=\textwidth]{fig/LabelBias}
		\caption{Ilustrace \uv{Label Bias} prolblému}
		\label{fig:GrafLabelBias}
\end{figure}

\section{Viterbi algorithm}
\label{sec:viterbi}
Byl navrhnut v roce 1967 Andrewem Viterbi jako dekódovací algoritmus pro konvoluèní kódy v telekomunikaèních sítích. Kvùli svému zamìøení na vyhledání nejpravdìpodobnìj¹í cesty sekvencí skrytých stavù (nejèastìji HMM) se v¹ak pou¾ívá v mnoha odvìtvích, jako zpracování signálù a také znaèkování jazyka. 

Za pøedpokladu, ¾e vstupní data mají stejný poèet pozorovaných a skrytých stavù, obì posloupnosti jsou zarovnané a výpoèet v daném místì je závislý pouze na aktuálním a pøedchozím prvku, je pomocí získána tzv. Viterbiho cesta -- nejpravdìpodobnìj¹í cesta posloupností.  V ka¾dém kroku algoritmus vyhodnotí v¹echny cesty vedoucí k aktuálnímu stavu a ponechá pouze jednu, díky èemu¾ není nucen uchovávat v¹echny existující cesty, ale pouze jednu pro ka¾dý stav. Za pomocí uchovávaní ceny stavu se poka¾dé algoritmus rozhodne ze v¹ech mo¾ností pro dal¹í stav a ulo¾í kompletní cestu od zaèátku prùchodu posloupností.

\section{Forward-backward algorithm}
\label{sec:forw-back}
Pou¾ívá dva prùchody posloupností stavù -- dopøedu a zpìt (podle toho také vznikl jeho název). Nejdøíve projde celou sekvenci a urèí cenu cesty pøi daném prùchodu. Poté projde sekvencí zpìt a pøi ka¾dém kroku spoèítá pravdìpodobnost pozorování zbylých vstupních hodnot. Oba tyto prùchody jsou poté \uv{vyhlazeny} do spoleèného výsledku a tím je získáno rozdìlení mezi stavy v jednotlivých jednotkách èasu. Speciálním pøípadem je poté Baum-Welch algoritmus.
%TODO ZJISTIT VICE??

\section{L-BFGS}
\label{sec:lbfgs}
L-BFGS (viz.\cite{Nash}) oznaèuje nízko pamì»ovou (Low memory) úpravu optimalizaèní metody BFGS (Broyden-Fletcher-Goldfarb-Shanno) z rodiny Quasi-Newtonových metod, urèenou k aproximaci inverzní Hessovy matice (ètvercová matice druhých parciálních derivací funkce -- popisuje místní zakøivení funkce o nìkolika promìnných). Optimalizací pro sní¾ení pamì»ové nároènosti je neukládání matice samotné, ale pouze ukládá historii zmìn.

\section{Stochastic Gradient Descent}
\label{sec:sgd}

\section{Regularizace L1}
\label{sec:l1}

\section{Regularizace L2}
\label{sec:l2}

\chapter{Informaèní systém}
Z dùvodu velkého mno¾ství jednotlivých testù, rùzných nastavení a strojù, na kterých testování bì¾í, jsem se rozhodl vytvoøit za pomoci open-source CMS systému Drupal informaèní, který mi pomù¾e udr¾ovat si pøehled o v¹ech spu¹tìných testech a o jejich výsledcích. Systém byl vytvoøen jako modul, pou¾itelný na jakékoliv webové stránce, pou¾ívající k ulo¾ení informací databázi dané stránky (dle standardu systému Drupal).

\paragraph{Systém je rozdìlen na 5 èástí}
\begin{itemize}
	\item Spu¹tìní nového testu
	\item Dokonèení bì¾ícího testu
	\item Zobrazení bì¾ících testù
	\item Zobrazení dokonèených testù
	\item Zobrazení náhledu na v¹echny testy a jejich rysy
\end{itemize}

\section{Návrh databáze}
Pro systém byla navr¾ena jednoduchá databáze, sestávající ze 4 tabulek a poskytující dostatek prostoru pro pøípadná roz¹íøení, o dal¹í rysy, nebo sledované výsledky.

\section{Spu¹tìní testu}
Pøi spu¹tìní se do systému zadávají následující data:
\begin{itemize}
	\item Název pou¾itého programu
	\item Identifikátor poèítaèe, na kterém testování bì¾í
	\item Popis testování
	\item Typ regularizace
	\item Poèet vstupních vìt pou¾itých pro testování
	\item Poèet vstupních vìt pou¾itých pro evaluaci
	\item Maximální poèet iterací
	\item Delta
	\item Pou¾ité rysy
	\item Pou¾ité èásti znaèky
\end{itemize}

\section{Dokonèení testu}
Pøi ukonèení testu se poté dodají informace, které pou¾ijeme pøi odvozování výsledkù a grafù. Mezi tyto informace patøí následující:
\begin{itemize}
	\item Poèet slov pou¾itých pøi trénování
	\item Poèet unikátních znaèek v trénovacích datech
	\item Poèet iterací
	\item Èas zaèátku a èas konce trénování
	\item Doba evaluace -- znaèkování
	\item Poèet rysù na zaèátku a na konci
	\item Velikost modelu
	\item Procentuální úspì¹nost znaèkování u jednotlivých slov a u vìt
\end{itemize}

\section{Zobrazení bì¾ících a skonèených testù, zobrazení náhledu}
Na tìchto stránkách si poté mù¾eme prohlédnout výsledky, které mù¾eme pozdìji pou¾ít k dal¹ím úèelùm. V prùbìhu testování je poté dùle¾itá stránka zobrazení náhledu, která nám zobrazuje, které testy ji¾ byly provedeny, nebo právì bì¾í, a dává nám tak jednoduchou mo¾nost rozmyslet, které testy by bylo vhodné spustit.

\chapter{Prostøedí testù a pou¾itý software}
\label{chap:prostredi}
\section{Operaèní systém}
Aèkoliv v¹echny vyu¾ívané programy a skripty jsou multiplatformní, v¹echny testy byly spou¹tìny na operaèním systému Linux nainstalovaném na univerzitních strojích, ke kterým jsem se vzdálenì pøipojoval pøes ssh. 
\section{Hardware}
Testování probíhalo prùbì¾nì a¾ na 10 rùzných poèítaèích, kde tøi znich jsou dostupné pro v¹eobecné vyu¾ítí (Athena 1 -- 3) a zbylé jsou pøístupné pouze pro výzkum zpracování jazyka (Pcnlp1 -- 8, krom 2, na kterém bì¾í OS Windows). Z dùvodu rozdílného hardware na jednotlivých strojích se poté pøi testování projevují velké skoky ve výsledných èasech. V tabulce ~\ref{tab:PouziteStroje} je zobrazena struèná charakteristika jednotlivých strojù.
%TODO Dopsat sem jejich vykon??
\begin{figure}
	\begin{center}
		\begin{tabular}{|l|l|c|}
			\hline
			\multicolumn{1}{|c|}{Název} &
			\multicolumn{1}{|c|}{CPU} & 
			\multicolumn{1}{|c|}{Velikost Pamìti} \\
			\hline
			Athena 1 & 2 x Dual-Core AMD Opteron(tm) Processor 2220 @ 2,8GHz &
			16GB \\
			Athena 2 & 2 x Dual-Core AMD Opteron(tm) Processor 2220 @ 2,8GHz &
			16GB \\
			Athena 3 & 2 x Six-Core AMD Opteron(tm) Processor 2435 @ 2,6GHz &
			64GB \\
			Pcnlp 1 & Intel(R) Core(TM)2 Quad CPU Q6700 @ 2.66GHz &
			4GB \\
			Pcnlp 3 & Intel(R) Core(TM)2 Duo CPU E6750 @ 2.66GHz &
			2GB \\
			Pcnlp 4 & Intel(R) Core(TM)2 Duo CPU E6750 @ 2.66GHz &
			2GB \\
			Pcnlp 5 & Intel(R) Core(TM)2 Duo CPU E6750 @ 2.66GHz &
			2GB \\
			Pcnlp 6 & Intel(R) Core(TM)2 Duo CPU E6750 @ 2.66GHz &
			2GB \\
			Pcnlp 7 & Intel(R) Core(TM)2 Duo CPU E8400 @ 3.00GHz &
			2GB \\
			Pcnlp 8 & Intel(R) Core(TM)2 Duo CPU E8300 @ 2.83GHz &
			2GB \\
			\hline
		\end{tabular}
		\captionof{table}{Charakteristika stroujù pou¾itých pøi zpracování projektu}
		\label{tab:PouziteStroje}
	\end{center}
\end{figure}

\pagebreak

\section{CRF++}
\label{sec:crfpp}
Program CRF++~\ref{crfpp} je open-source implementací Conditional Random Fields, urèenou pro znaèkování sekvenèních dat. Nabízí se tedy jako jeden z kandidátù pro potøeby této práce. Program je napsán v jazyce C++ za pou¾ití STL knihovny. K urèení parametru pou¾ívá algoritmu L-BFGS. Implementuje také mo¾nost bigramù -- rysù, fungujících jako pøechod mezi pøedchozím a souèasným prvkem. Tato vlastnost je v¹ak z dùvodu velkého poètu znaèek vysoce nároèná.

Nevýhodou programu je zdrojový kód bez jakýchkoliv komentáøù a tím pádem naprosto nevhodný k jakýmkoliv zásahùm, èí úpravám pro na¹e potøeby. Pøi vyu¾ití tohoto programu jsem se také potýkal s problémy s chybou SIGSEGV. Kód se zøejmì nebyl schopen vypoøádat s vysokým poètem unikátních znaèek a pøi pou¾ití v¹ech kategorii a vy¹¹ího poètu vstupù vyvolal zmínìnou vyjímku a ukonèil se.

\subsection{Zpùsob testování}
Pøi mo¾nosti poèítat s pøedchozím prvkem, urèeným algoritmem, se nabízí ji vyu¾ít v na¹em programu. Bohu¾el, s délkou èeské znaèky také pøichází kámen úrazu, kdy program nechápe \uv{smysl} pøedchozí znaèky, ale bere ji jako celek (z dùvodu optimalizací je øetìzec pøeveden na èíslo, se kterým jsou poté v¹echny operace mnohem rychlej¹í). Nemù¾e tedy vyu¾ít jednotlivých èástí èeské znaèky k vytvoøení samostatných pravidel. Tím se sni¾ují mo¾nosti zpracování a efektivity pou¾itých algoritmù, stejnì jako generování rysù. Pøi pokusech o vyøe¹ení tohoto problému jsem vytvoøil skript, který postupnì zpracovává èásti znaèky a poté je pou¾ívá pøi trénování dal¹ích krokù. Tento pøístup je v¹ak velmi krkolomný a celkovì nepøinesl markantní nárùst úspì¹nosti.

\subsection{Znaèkování textu}
V pøípadì tohoto programu se pravidla na tvorbu rysù pøedávají jako konfiguraèní soubor a proto je nutné v¹echny pøedbì¾né úpravy udìlat u¾ na vstupních datech. K tomuto úèelu byl vytvoøen skript v jazyce awk, který je poté volán z hlavního skriptu, starajícího se o celý prùbìh trénování. 

Nastavení v konfiguraèním souboru jsou poté tvoøena písmenem, urèujícím, zda jde o unigram (vztahujícíc se pouze k souèasnému prvku posloupnosti), èi o bigram (vý¹e zmínìný pøechod mezi pøedchozím a aktuálním prvkem). Poté následuje dvouciferný identifikátor rysu, zajis»ující unikátnost vùèi ostatním definicím, dvojteèkou a øetìzcem definujícím pou¾itá vstupní data. K tomu je vyu¾íván zápis \%[x,y], kde x oznaèuje relativní pozici mezi slovy (0 oznaèuje aktuální, záporné èíslo pøedchozí a kladné následující prvek) a y oznaèuje sloupec vstupních dat, který má být pou¾it. Celé pravidlo poté mù¾e vypadat napø. takto: U01:\%[0,1].

Jeliko¾ znaèkování probíhá v nìkolika krocích, kdy v ka¾dém z nich nám pøibude dal¹í sloupec a dal¹í souvislosti mezi daty, je nutno pøipravit pro ka¾dý krok samostatný konfiguraèní soubor. Také je dùle¾ité správnì jej nastavit pro co nejlep¹í výslednou úspì¹nost.

Pro øízení procesu byl sepsán skript v jazyce BASH, který vyu¾ívá programu pro tvorbu vstupních dat, napsaného v jazyce C, pøevádìjícího øetìzce na èísla, a dal¹ího skriptu v jazyce awk urèeného ke koneèné analýze úspì¹nosti.

\subsection{Pou¾ité rysy}
Z dùvodu nìkolika-krokového charakteru testování se rysy velmi li¹í, veskrze jde v¹ak pouze o kombinace pøedchozích a aktuálních prvkù vstupních souborù. Také byly pou¾ity nìkolikanásobné rysy, skládající se zároveò ze dvou prvkù (minulá a souèasná znaèka apod.). Pro tyto pravidla mi povìt¹inou byly inspirací existující konfiguraèní soubory pou¾ívané pro trénování anglického jazyka, které byly souèástí pøíkladù pou¾itých v programu CRF++. Pro tvoøení rysù bylo pou¾ito: Tvar slova, Lemmata (slo¾enina v¹ech mo¾ných lemmat), èást znaèky, urèující slovní druh (pokud se shodovala ve v¹ech mo¾nostech vstupních dat) a prùbì¾nì získaných výsledkù.

\subsection{Rozdìlení zpracování na kroky}
Správné rozdìlení bylo testováno, motivací v¹ak bylo nejdøíve natrénovat nejdùle¾itìj¹í èásti znaèky a pokraèovat s ménì významnými sloupci. Pøi tomto testování se tedy bude moci ji¾ pou¾ít natrénovaných dat k lep¹ím výsledkùm. V prvním kroku proto bylo èasto pou¾ito slovního druhu a jeho detailu, v druhém rodu, osoby, pádu a ve tøetím nìkolika ze zbylých vlastností. 

\subsection{Výsledky testování}
Testù bylo vykonáno nìkolik desítek, vìt¹ina z nich v¹ak nepøiná¹ela ký¾ené výsledky. V tabulce ~\ref{tab:CRFVysledky} proto zahrnuji pouze vzorek dat s uspokojivými výsledky.

\begin{table}
	\begin{center}
		\begin{tabular}{|c|r|r|c|c|r|r|}
			\hline
			\multicolumn{1}{|c|}{Id testu} &
			\multicolumn{1}{|c|}{Poèet vìt} & 
			\multicolumn{1}{|c|}{Eta} &
			\multicolumn{1}{|c|}{Krok è.} &
			\multicolumn{1}{|c|}{Èásti znaèky} &
			\multicolumn{1}{|c|}{Poèet pøíznakù} &
			\multicolumn{1}{|c|}{Úspì¹nost} \\
			\hline
			1 & 3000 & 0.05  & 1 & 1100000000000000 & 1318350 & 94.099\% \\
			  &      &       & 2 & 0010100100000000 & 2354463 & 59.105\% \\
			  &      &       & 3 & 0001000010000000 & 299812  & 80.526\% \\
			\hline
			2 & 3000 & 0.005 & 1 & 1100000000000000 & 2065745 & 92.487\% \\
		 	  &      &       & 2 & 0010100100000000 & 1716750 & 75.100\% \\
			  &      &       & 3 & 0001000110000000 & 897138  & 87.055\% \\ 
			\hline
			2 & 5000 & 0.005 & 1 & 1100000000000000 & 1318350 & 94.312\% \\
			  &      &       & 2 & 0010100000000000 & 1097024 & 71.303\% \\
			  &      &       & 3 & 0001000110000000	& 596079  & 84.856\% \\
			\hline
		\end{tabular}
		\captionof{table}{Výsledky testování pøi vyu¾ití programu CRF++}
		\label{tab:CRFVysledky}
	\end{center}
\end{table}

\subsection{Odklon od programu}
Ze v¹ech vý¹e zmínìných dùvodù (padání programu, nekomentovaného kódu, \ldots) a také po zkoumání dal¹ích existujících øe¹ení, o kterých jejich autoøi tvrdí, ¾e jejich díla jsou øádovì rychlej¹í, ne¾ CRF++, jsem se rozhodl tento program opustit a tím pádem jsem ze získaných dat nevyvodil ¾ádné závìry, nebo» by v koneèném dùsledku byly pouze zbyteènou prací, nemající vliv na závìreèný výsledek celé práce.

\pagebreak

\section{CRFSuite}
\label{sec:crfsuite}
Program CRFSuite~\ref{crfsuite} je open-source implementací algoritmu Conditional Random Fields, urèený pro znaèkování sekvenèních dat. Je naprogramován v èistém C a dle jeho autora optimalizován pro co nejvy¹¹í rychlost za obìtování obecnosti. Jeho autorem je pak Ph.D Naoaki Okazakim pùsobícím na univerzitì v Tokyu. Program ke svému chodu vy¾aduje knihovnu libLBFGS od stejného autora, z èeho¾ vyplývá ¾e urèení parametru je vykonáno za pomoci algoritmu L-BFGS. V nastavení programu je v¹ak mo¾no tuto volbu zmìnit na SGD, které je dle poznámek inspirováno implementací pou¾itou v dal¹ím programu CRFSGD~\ref{crfsgd}. Pøi trénování je poté mo¾né vyu¾ít jednu z regularizací. V¹echny vyu¾ité algoritmy poté mohou být ovlivnìny mnoha dal¹ími nastaveními, ovlivòujícími od ukonèovacích podmínek po rùzné parametry mìnící jejich chování pøi trénování dat.

\subsection{Znaèkování textu}
Ke znaèkování je pou¾it skript v jazyce python, který se stará o analýzu vstupních dat, jejich úpravu a vytvoøení souboru, obsahujícího pøipravené znaèky pro externí program.
 
Skript postupnì naèítá data ze vstupního souboru a vytváøí multidimenzionální pole pro pozdìj¹í zpracování. Pøi tomto kroku také provádí urèité pøídavné operace, které pomáhají rychlosti pozdìj¹ích krokù, jako pøed-generování pøípon slov, èím¾ urychluje pozdìj¹í zpracování. Z vytvoøených dat jsou poté budovány rysy podle námi zadaných pravidel. Jak je vyobrazeno v tabulce ~\ref{tab:VstupniData}, v na¹em pøípadì máme v ka¾dém øádku, reprezentujícím jedno slovo, ulo¾ených 5 sloupcù.

\begin{table}[bp]
	\begin{center}
		\begin{tabular}{|l|l|l|l|l|}
			\hline
			\multicolumn{1}{|c|}{Pozice 1} &
			\multicolumn{1}{|c|}{Pozice 2} &
			\multicolumn{1}{|c|}{Pozice 3} &
			\multicolumn{1}{|c|}{Pozice 4} &
			\multicolumn{1}{|c|}{Pozice 5} \\
			\hline
			Tvar slova &
			Nemìnná èást znaèky & 
			Mo¾ná lemmata & 
			Pøípona slova &
			Správná znaèka \\
			\hline
		\end{tabular}
		\captionof{table}{Rozlo¾ení jednoho øádku vstupních dat}
		\label{tab:VstupniData}
	\end{center}
\end{table}

Jako první poté, dle formátu cíleného programu, vypí¹e správnou znaèku, následovanou v¹emi rysy, tvoøenými podle zadaných pravidel. V¹echny rysy jsou tak vytvoøeny pøed samotným spu¹tìním testovacího programu a v prùbìhu testování se ji¾ nemìní -- mohou pouze být vypu¹tìny buï pøed samotným zaèátkem (kvùli minimálnímu limitu), nebo odstranìny pøi vykonávání regularizace.

\subsection{Analýza pøed tvorbou znaèek}
Jeliko¾ pro ka¾dé slovo máme ve vstupních datech dostupné v¹echny mo¾né znaèky, mù¾eme tyto informace vyu¾ít pro tvorby rysù pro dal¹í zpracování. Skript zkontroluje v¹echny mo¾nosti a vybere v¹echny sloupce znaèky, které se shodují. Dále spojí dohromady v¹echna mo¾ná lemmata a oddìlí je mezi sebou lomítkem. Vytvoøí se také øetìzec obsahující pøíponu, který pro v¹echna slova del¹í ne¾ 2 znaky ulo¾í øetìzec, tvoøený dvìma posledními znaky.

\subsection{Pou¾ité rysy}
V na¹em projektu jsou jednak vyu¾ívány klasické rysy, které se pou¾ívají prakticky ve v¹ech typických pøíkladech vyu¾ití poèítaèového uèení ( pøedchozí prvek, následující prvek,... ), jednak speciální, které mají smysl pouze pro znaèkování textu, èi dokonce pouze pro èeský jazyk jako takový (výèet v¹ech rysù viz. tabulka ~\ref{tab:SeznamRysu}). 

V¹echny rysy dodr¾ují oznaèení, pou¾ívané ve vìt¹inì programù urèených k automatickému poèítaèovému uèení. Tímto je U na zaèátku, oznaèující unigram, co¾ znaèí, ¾e se pou¾ívá pouze prvek na aktuální pozici (prvek bigramu B je v implementaci programu CRFSuite vynechán). Za úvodním písmenem pak následuje = a èíslo rysu, urèené k odli¹ení rysù od sebe. Toto znaèení budeme vyu¾ívat i v této publikaci pro oznaèení a pozdìj¹í referenci na námi pou¾ité rysy.

\begin{table}[htbp]
	\begin{center}
		\begin{tabular}{|c|l|}
			\hline
			\multicolumn{1}{|c|}{ID} &
			\multicolumn{1}{|c|}{Popis} \\
			\hline
			U00 & Slovní tvar na pozici x-2 \\
			U01 & Slovní tvar na pozici x-1 \\
			U02 & Slovní tvar na pozici x \\
			U03 & Slovní tvar na pozici x+1 \\
			U04 & Slovní tvar na pozici x+2 \\
			U10 & Znaèka (spoleèná èást) na pozici x-2 \\
			U11 & Znaèka (spoleèná èást) na pozici x-1 \\
			U12 & Znaèka (spoleèná èást) na pozici x \\
			U13 & Znaèka (spoleèná èást) na pozici x+1 \\
			U14 & Znaèka (spoleèná èást) na pozici x+2 \\
			U20 & Mo¾ná lemmata na pozici x-2 \\
			U21 & Mo¾ná lemmata na pozici x-1 \\
			U22 & Mo¾ná lemmata na pozici x \\
			U23 & Mo¾ná lemmata na pozici x+1 \\
			U24 & Mo¾ná lemmata na pozici x+2 \\
			U30 & Pøípona na pozici x-2 \\
			U31 & Pøípona na pozici x-1 \\
			U32 & Pøípona na pozici x \\
			U33 & Pøípona na pozici x+1 \\
			U34 & Pøípona na pozici x+2 \\
			U40 & Pøedpona -- první písmeno slova \\
			U41 & Pøedpona -- první dvì písmena slova \\
			U42 & Pøedpona -- první tøi písmena slova \\
			U43 & Koncovka -- poslední písmeno slova \\
			U50 & Velikost písmen -- v¹echny malé, v¹echny velké, první velké \\
			U51 & Èíslo, oznaèující pozici ve vìtì \\
			U52 & Délka slova \\
			U53 & Znaèka nejbli¾¹ího slovesa ( vyhledáváno dopøedu i dozadu) \\
			\hline
		\end{tabular}
		\footnotetext[1]{x oznaèuje aktuální pozici ve vìtì}
		\captionof{table}{Seznam rysù pou¾itých pøi testování programem CRFSuite}
		\label{tab:SeznamRysu}
	\end{center}
\end{table}

\subsection{Pou¾ití pouze èásti znaèky}
Z dùvodu u¹etøení èasu a teoretické jednodu¹¹í mo¾nosti natrénování (odvozování pravidel od men¹ího poètu celkových znaèek a tím pádem vy¹¹ího poètu podobných znaèek, poskytujícím vy¹¹í pravdìpodobnost ovlivnìní modelu) byly pøi testování spou¹tìny testy s ne v¾dy kompletní znaèkou, ale pouze s jejími nejdùle¾itìj¹ími èástmi. Je nutno v¹ak vìdìt, pro jaký konkrétní úèel by mìl program slou¾it -- v pøípadì nutnosti komplexních informacích o slovech by tento pøístup k problému byl nevhodný. Proto se také budu sna¾it v testování k tomuto pøihlédnout a provézt testy jak s kompletní, tak s omezenou znaèkou a výsledky mezi sebou porovnat. 
%TODO Upravit text!!

\subsection{Zpùsob testování}
Z dùvodu kvalitních výsledkù a rychlosti této implementace byla hlavní èást celé práce provedena za pou¾ití tohoto programu a je mu tedy vìnováno mnohem více prostoru, ne¾ pøedchozímu CRF++. Pro urychlení celého testování jsem také vytvoøil øadu nástrojù, které mi celý proces zjednodu¹ily a dovolily mi více se zamìøit na analýzu výsledkù, ne¾ na testování samotné.

\subsubsection{Skripty}
Pro testování jsem vytvoøil skript v jazyce BASH, starající se o celý prùbìh testu (viz. tabulka ~\ref{tab:PrubehTestovani}) a ulehèující nastavení celé procedury a èitelnost pou¾itých parametrù. V hlavièce jsou definovány základní údaje a nastavení, které jsou poté pou¾ity v tìle pro postupné spou¹tìní jednotlivých pøíkazù. V prùbìhu této operace jsou poté logovány v¹echny dùle¾ité údaje, které jsou potom lehce pøístupné k následujícímu zpracování. Tento skript je poté naklonován pro ka¾dý vyu¾ívaný poèítaè a tím je poskytnuta zpìtná mo¾nost kontroly nastavených údajù a vyhnutí se chyb spojených s prací na více strojích najednou. Stejný pøístup byl aplikován i na skript, generující data z csts souboru. Ten je tedy také nakopírován pro ka¾dý poèítaè a jeho parametry jsou v¾dy lehce dohledatelné. Pro dvojí kontrolu je v¹ak pøípadný seznam vynechaných rysù pøepsán i do hlavního skriptu.

\begin{table}[bp]
	\begin{center}
		\begin{tabular}{|c|l|l|}
			\hline
			\multicolumn{1}{|c|}{Èíslo kroku} &
			\multicolumn{1}{|c|}{Program} &
			\multicolumn{1}{|c|}{Popis kroku} \\
			\hline
			1 & Øídící skript & Spu¹tìní konverzního skriptu pro trénovací data \\
			2 & Konverzní skript & Vygenerování trénovacích dat \\
			3 & Øídící skript & Spu¹tìní programu CRFSuite s trénovacími daty \\
			4 & CRFSuite learn & Naètení vstupních dat \\
			5 & CRFSuite learn & Natrénování \\
			6 & CRFSuite learn & Vytvoøení modelu \\
			7 & Øídící skript & Spu¹tìní konverzního skriptu pro testovací data \\
			8 & Konverzní skript & Vygenerování testovacích dat \\
			9 & CRFSuite tag & Naètení vstupních dat \\ 
			10 & CRFSuite tag & Provedení jedné iterace a vypsání výsledku a statistik \\
			11 & Øídící skript & Odeslání emalu se zprávou \\
			\hline
		\end{tabular}
		\captionof{table}{Prùbìh testování a popis jednotlivých akcí}
		\label{tab:PrubehTestovani}
	\end{center}
\end{table}

\subsubsection{Spu¹tìní}
S pou¾itím vytvoøených nástrojù je poté spu¹tìní testování velmi lehkou a rychlou zále¾itostí. Nejdøíve je v python souboru (pojmenovaném jako \texttt{[jméno stroje].py}) nastaveno, které rysy mají být pou¾ity. Poté se v bash scriptu ([jméno stroje].sh) nastaví poèet vìt pro trénování a testování, maximální poèet iterací, epsilon, regularizace a dal¹í pøípadné parametry. Dále je nutno upravit pomocí programu ulimit limity zdrojù, dostupných pro ná¹ program -- jedná se konkrétnì o maximální velikost stacku, maximální èas cpu a maximální velikost virtuální pamìti. Ke spou¹tìní skriptu je poté pou¾it program nohup, zaji¹»ující pøetrvávající bìh programu i po odpojení se od vzdáleného poèítaèe. 

\subsubsection*{Pøíklad:}

\begin{verbatim}
		$ nohup ./[název stroje].sh \&
		$ nohup ./pcnlp3.sh \&
\end{verbatim}

Po dokonèení procesu poté skript ode¹le email na nastavenou emailovou adresu a ve slo¾ce pøibudou dva soubory: \texttt{[název stroje].log} s údaji o trénování a \texttt{[název stroje].result} s údaji o výsledku trénování.

\chapter{Testy}
\label{chap:testy}
Pøed zapoèatím øádného testování a analýzy výsledkù bylo potøeba se rozhodnout s jakými parametry bude testování provádìno. V¹echny následující testy jsou provedeny v programu CRFSuite, který, jak je zmínìno vý¹e, pro tento projekt pøiná¹í mnohem vhodnìj¹í prostøedí. Program nabízí velké mno¾ství nastavení ovlivòujícího vlastní algoritmus urèení parametru, nebo podmínky pro jeho ukonèení. Pro tuto práci jsem se rozhodl zpracovávat testy za pou¾ití regularizace L1 (viz. podkapitola~\ref{sec:l1}) a L2 (viz. podkapitola~\ref{sec:l2}) a poté porovnat jejich výsledky. Vìt¹ina testù je zpracována s vyu¾itím algoritmu L-BFGS (viz. podkapitola~\ref{sec:lbfgs}), v prùbìhu práce jsem v¹ak objevil, ¾e algoritmus SGD (viz. podkapitola~\ref{sec:sgd}) poskytuje lep¹í výsledky za ni¾¹í èas. Bohu¾el v¹ak ji¾ bylo pozdì na zmìnu metodiky a vìt¹ina testù ji¾ byla zpracována, do práce je tak pøidáno krátké srovnání mezi výsledky obou zmínìnych algoritmù a pravidla, zji¹tìná pro L-BFGS budou aplikována i na SGD. %TODO smazat SGD pokud jsem to nestihl

Dal¹í volbou byl zpùsob ukonèení trénování -- nabízely se dvì mo¾nosti: Buï ukonèení po urèitém poètu iterací, nebo pøi dosa¾ení hodnoty delta, urèující rozdíl mezi úspì¹ností dvou po sobì následujících iterací. Která z nich je kvalitnìj¹i se te¾ce posuzuje, v pozdìj¹ích fázích zpracování jsem se v¹ak rozhodl, ¾e zpracování pomocí hodnoty delta poskytuje vìt¹í procesu testování vy¹¹í variabilitu a tím mo¾nost správnì vyu¾ít aktuálního nastavení (co¾ bylo pozdìji potvrzeno mnohem vy¹¹í poètem iterací pøi regularizaci L2 namísto L1)

Jako dal¹í problém se poté ukázal poèet testovacích vzorkù, kde pøi pou¾ití vìt¹ího poètu, ne¾ 7000 program CRFSuite z nezji¹tìných dùvodù odmítl vydat jakékoliv výsledky a zøejmì se zacyklil pøi vnitøní chybì. Vlastní proces stále visel v systému, nejevil v¹ak ¾ádné známky aktivity a proto musel být ruènì ukonèen (nejdéle jsem na dokonèení èekal v rámci dnù, i kdy¾ pro poèet 7000 se doba vìt¹inou pohybuje v øádu nìkolika desítek minut). Pro pøesnìj¹í mìøení by tedy zøejmì bylo výhodnìj¹í výsledky je¹tì validovat oproti dal¹ím vzorkùm dat, pro základní porovnání výkonnosního pøínosu jednotlivých rysù by v¹ak mìl být tento poèet naprosto dostaèujícím.

Pøi provedení v¹ech testù pùjde vidìt, ¾e èasy trénování a testování nerostou podle nároènosti úlohy, ale jsou urèeny zdánlivì náhodnými hodnotami. Toto je v¹ak samozøejmì zpùsobeno trénováním na nìkolika rùzných strojích, poskytujících diametrálnì odli¹ný výpoèetní výkon. V závìru se pokusím urèit konstantu, urèující výkon jednotlivých strojù a tím alespoò nastínit rozdíly mezi jednotlivými zpracováními. Doba zpravování v¹ak ani v tomto pøípadì nejspí¹e neporoste lineárnì, nebo» je ovlivnìna i dal¹ími faktory, napøíklad mo¾ností, ¾e na daných strojích v prùbìhu mého testování probíhaly i jiné procesy, které mohly ovlivnit vytí¾ení procesorù.

\section{Závislost úspì¹nosti na poètu vstupních vìt}
Následující testy se zabývají analýzou ideálního poètu vìt pro pou¾ití v dal¹ích èástech projektu. Je nutno získat takovou hodnotu, která bude poskytovat jednak kvalitní, jednak èasovì akceptovatelné výsledky, které poskytnou mo¾nost zpracovat v¹echny èasovì nároèné testy na daném poètu strojù.

\subsection{Pøi konstantním poètu iterací a regularizaci L1}

\subsubsection*{Pøíprava:}
Nejdøíve bylo tøeba rozhodnout, jaký poèet iterací bude vhodný pro proces testování. Po nìkolika pokusných testech se jako nejlep¹í ukázalo èíslo 50. Okolo této hodnoty program ji¾ zaèal pùlit kroky algoritmu pro vy¹¹í pøesnost a tím se exponencionálnì zvy¹ovala nároènost ka¾dého dal¹ího kroku aproximace parametru. Pro dokonèení 60. iterace proto bylo èas vzrostl øádovì 3krát, zatím co úspì¹nost se zvý¹ila pouze minimálnì. Z dùvodu rozumného vyu¾ití prostøedkù jsem se tedy rozhodl pro testování ohranièit maximální poèet iterací èíslem 50. V prùbìhu testování jsem toto omezení pøehodnotil a zaèal vyu¾ívat ohranièení pomocí minimální zmìny, které by teoreticky mìlo ménì omezovat pøípadnou vy¹¹í efektivitu pøi vyu¾ití jiných pøíznakù.

\subsubsection*{Konstantní podmínky:}
\emph{Algoritmus:} L-BFGS\\
\emph{Maximální poèet iterací:} 50\\
\emph{Èásti znaèky:} 1 -- 5 a 8 -- 9\\
\emph{Poèet vìt pøi testování úspì¹nosti: }7000\\
\emph{Regularizace:} L1

\subsubsection*{Vyhodnocení}
Jak lze vidìt v tabulce~\ref{tab:RegL1KonstIter}, pøi prvních dvou testech (5000 a 10 000 vstupních vìt) a také v pøedposledním testu (55000 vìt) se s nejvìt¹í pravdìpodobností vyskytla chyba v programu CRFSuite, projevující se nezvykle vysokými hodnotami úspì¹nosti. Vìt¹inu z tìchto podezøelých testù jsem spou¹tìl znovu, nebo» jsem pøedpokládal chybu na své stranì. Ani po pøetestování\footnote[1]{Pro ovìøení byly zvovu provedeny testy s následujícím poètem vìt: 5 000, 10 000, 55 000, 50 000} se v¹ak daná hodnota nezmìnila. Testy jsem zkou¹el spou¹tìt i na jiných strojích, co¾ ale na výsledcích nic nezmìnilo. Tyto podivné výsledky se pozdìji vyskytují i v dal¹ích testech. 

Nebýt tøech podivných výsledkù, je jasnì vidìt stoupající tendence testù a¾ k 50 000 vìt. Od této úrovnì u¾ se poté úspì¹nost spí¹e sni¾uje -- co¾ mù¾e být zpùsobeno omezením maximálního poètu iterací na 50. 

Jak bylo zmínìno vý¹e (viz. kapitola ~\ref{chap:prostredi}), doba trénování neroste lineárnì, nebo» pokusy byly provádìny na rùzných strojích o rùzném výpoèetním výkonu. Celková doba procesu testování je ve v¹ech pøípadech velmi podobná a je závislá témìø èistì na výkonu procesoru a poètu vstupních prvkù. V tomto pøípadì se pohybovala od 300 do 700 sekund a proto jsem se z dùvodu u¹etøení místa v tabulce rozhodl tuto informaci nezapisovat do tabulky výsledkù. 

Z rozdílu mezi poètem úvodních a koneèných rysù lze dobøe pozorovat pøínost vyu¾ité regularizace, odmazávající nevýrazné rysy. Koneèný poèet je tak v prùmìru 4 krát ní¾¹í, èím¾ se i sni¾uje velikost výsledného modelu. Toto bude rozebráno v . %TODO doplnit kde je to rozebrano

\begin{table}
	\begin{center}
		\begin{tabular}{|c|r|r|r|r|r|r|r|r|}

			\hline
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Doba} &
			\multicolumn{1}{|c|}{Velikost} &
			\multicolumn{1}{|c|}{Úvodní} &
			\multicolumn{1}{|c|}{Koneèný} &
			\multicolumn{1}{|c|}{Úsp.} &
			\multicolumn{1}{|c|}{Úsp.} \\

			\multicolumn{1}{|c|}{vìt} &
			\multicolumn{1}{|c|}{znaèek} &
			\multicolumn{1}{|c|}{trénování} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{poèet rysù} &
			\multicolumn{1}{|c|}{poèet rysù} &
			\multicolumn{1}{|c|}{slov} &
			\multicolumn{1}{|c|}{vìt} \\
			\hline
			5000 & 671 & 5h 30m & 4751828B & 558871 & 113149 & 91.04\% & 34.70\% \\ 
			10000 & 743 & 20h 47m & 8326164B & 905326 & 200613 & 92.65\% & 43.02\% \\ 
			15000 & 769 & 23h 46m & 10990504B & 1202680 & 266245 & 87.90\% & 7.73\% \\ 
			20000 & 792 & 33h 41m & 13706360B & 1464587 & 334939 & 88.37\% & 8.07\% \\ 
			25000 & 811 & 45h 25m & 17140200B & 1724528 & 423649 & 88.68\% & 8.20\% \\ 
			30000 & 822 & 37h 56m & 18953540B & 1968646 & 461337 & 88.71\% & 7.99\% \\ 
			35000 & 833 & 56h 44m & 22744448B & 2260670 & 564590 & 89.38\% & 10.26\% \\ 
			40000 & 843 & 66h 54m & 23583752B & 2488724 & 586499 & 90.12\% & 15.69\% \\ 
			45000 & 849 & 128h 26m & 27177664B & 2716001 & 680082 & 90.62\% & 18.99\% \\
			50000 & 854 & 199h 44m & 28602144B & 2924981 & 717070 & 89.45\% & 6.85\% \\ 
			55000 & 867 & 90h 22m & 30087008B & 3140944 & 758370 & 94.74\% & 53.77\% \\ 
			60000 & 870 & 111h 35m & 34118604B & 3329504 & 863220 & 89.63\% & 8.05\% \\
			\hline
		\end{tabular}
		\captionof{table}{Výsledky testù pøi regularizaci L1 a konstantním poètu iterací}
		\label{tab:RegL1KonstIter}
	\end{center}
\end{table}

\subsection{Pøi konstantním poètu iterací a regularizaci L1}

\subsubsection*{Pøíprava:}
V tomto pøípadì jsem vyu¾il stejných pravidel, jako u minulého testu, pouze jsem zmìnil regularizaci pro získání výsledkù k porovnání. Pouze jsem pøehodnotil velikost kroku mezi jednotlivými testy, kterou jsem v tomto pøípadì zvý¹il z 5 na 10 tisíc vìt a tím sní¾il celkový èas testu.

\subsubsection*{Konstantní podmínky:}
\emph{Algoritmus:} L-BFGS\\
\emph{Maximální poèet iterací:} 50\\
\emph{Èásti znaèky:} 1 -- 5 a 8 -- 9\\
\emph{Poèet vìt pøi testování úspì¹nosti: }7000\\
\emph{Regularizace:} L2

\subsubsection*{Vyhodnocení}
Jak je popsáno v podkapitole~\ref{sec:l2}, pøi regularizaci L2 je zachováván konstantní poèet rysù (proto je také v tabulce zobrazena pouze jeden sloupec, místo dvou v pøedchozím pøípadì) a tím pádem je zde teoretická vy¹¹í pravdìpodobnost úspìchu. Jak lze vidìt v tabulce~\ref{tab:RegL2KonstIter}, výsledná úspì¹nost roste bez vìt¹ích výkyvù od 10 a¾ po 70 tisíc vstupních vìt, kde se zvy¹ujícím se poètem rysù se rozdíl mezi jednotlivými kroky sni¾uje. Úspì¹nost se ve v¹ech pøípadech pohybuje nad hranicí 90 procent a poskytuje tedy velmi uspokojivé výsledky.

\begin{table}[htbp]
	\begin{center}
		\begin{tabular}{|c|r|r|r|r|r|r|r|r|}

			\hline
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Doba} &
			\multicolumn{1}{|c|}{Velikost} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Úsp.} &
			\multicolumn{1}{|c|}{Úsp.} \\

			\multicolumn{1}{|c|}{vìt} &
			\multicolumn{1}{|c|}{znaèek} &
			\multicolumn{1}{|c|}{trénování} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{rysù} &
			\multicolumn{1}{|c|}{slov} &
			\multicolumn{1}{|c|}{vìt} \\
			\hline
			10000 & 743 & 15h 56m & 36244240B & 905326 & 91.97\% & 40.64\% \\ 
			20000 & 792 & 44h 30m & 57072452B & 1464587 & 92.78\% & 45.28\% \\ 
			30000 & 822 & 42h 26m & 76697368B & 2002356 & 93.51\% & 48.41\% \\ 
			40000 & 843 & 84h 50m & 94190136B & 2488724 & 93.61\% & 49.06\% \\ 
			50000 & 854 & 128h 19m & 109663924B & 2924981 & 93.83\% & 50.26\% \\ 
			60000 & 870 & 181h 14m & 123654348B & 3329504 & 94.04\% & 51.09\% \\ 
			70000 & 881 & 191h 8m & 136263364B & 3697048 & 94.05\% & 51.52\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Výsledky testù pøi regularizaci L2 a konstantním poètu iterací}
		\label{tab:RegL2KonstIter}
	\end{center}
\end{table}

\subsection{Pøi konstantním poètu iterací - srovnání mezi L1 a L2}
U L2 je v porovnání s regularizací L1 (viz. tabulky~\ref{tab:L1L2KonstIterData}~a~\ref{tab:L1L2KonstIterEval}) úspì¹nost v rámci jednotlivých slov vy¹¹í o nìkolik procent a u celých vìt je rozdíl dokonce nìkolik desítek procent (nepoèítáme-li výsledky zpùsobené anomálií vyskytující se pøi nìkterých výsledcích u L1). Toto zlep¹ení je v¹ak vykoupeno skuteèností, ¾e velikost modelu je v prùmìru 4krát vy¹¹í a doba testování ze zvý¹ila pøibli¾nì o polovinu. Je tedy otázkou, zda je pro nás tato skuteènost akceptovatelná a zda nám stojí o zvý¹ení úspì¹nosti o nìkolik procent, nebo zda dáme pøednost malému modelu a rychlej¹ímu zpracování -- to u¾ by v¹ak zále¾elo na konkrétním vyu¾ití programu. Pøekvapivì se v¹ak nijak nezvý¹ila doba trénování, kdy rozdíl není jednoznaènì viditelný z dùvodu rozdílu ve výkonnosti jednotlivých strojù.

Ze srovnání lze mimochodem vypozorovat, ¾e nekonsistentní výsledky z testu s regularizací L1 se velmi pøibli¾ují výsledkùm s regularizací L2. 

\begin{table}[bp]
	\begin{center}
		\begin{tabular}{|c||r|r||r|r||r|r|}

			\hline
			\multicolumn{1}{|c||}{Poèet} &
			\multicolumn{1}{|c|}{L1 doba} &
			\multicolumn{1}{|c||}{L2 doba} &
			\multicolumn{1}{|c|}{L1 doba} &
			\multicolumn{1}{|c||}{L2 doba} &
			\multicolumn{1}{|c|}{L1 koneèný} &
			\multicolumn{1}{|c|}{L2 koneèný} \\

			\multicolumn{1}{|c||}{vìt} &
			\multicolumn{1}{|c|}{trénování} &
			\multicolumn{1}{|c||}{trénování} &
			\multicolumn{1}{|c|}{testování} &
			\multicolumn{1}{|c||}{testování} &
			\multicolumn{1}{|c|}{poèet rysù} &
			\multicolumn{1}{|c|}{poèet rysù} \\
			\hline
			10000 & 20h 47m & 15h 56m & 646s & 595s & 200 613 & 905 326 \\ 
			20000 & 33h 41m & 44h 30m & 527s & 935s & 334 939 & 1 464 587 \\ 
			30000 & 37h 56m & 42h 26m & 421s & 584s & 461 337 & 2 002 356 \\ 
			40000 & 66h 54m & 84h 50m & 604s & 555s & 586 499 & 2 488 724 \\ 
			50000 & 199h 44m & 128h 19m & 738s & 1516s & 717 070 & 2 924 981 \\ 
			60000 & 111h 35m & 181h 14m & 696s & 1913s & 863 220 & 3 329 504 \\ 
			\hline
		\end{tabular}
		\captionof{table}{Srovnání mezi L1 a L2 pøi konstantním poètu iterací (výsledky)}
		\label{tab:L1L2KonstIterData}
	\end{center}
\end{table}

\begin{table}[bp]
	\begin{center}
		\begin{tabular}{|c||r|r||r|r||r|r|}

			\hline
			\multicolumn{1}{|c||}{Poèet} &
			\multicolumn{1}{|c|}{L1 velikost} &
			\multicolumn{1}{|c||}{L2 velikost} &
			\multicolumn{1}{|c|}{L1 úsp.} &
			\multicolumn{1}{|c||}{L2 úsp.} &
			\multicolumn{1}{|c|}{L1 úsp.} &
			\multicolumn{1}{|c|}{L2 úsp.} \\

			\multicolumn{1}{|c||}{vìt} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c||}{modelu} &
			\multicolumn{1}{|c|}{slov} &
			\multicolumn{1}{|c||}{slov} &
			\multicolumn{1}{|c|}{vìt} &
			\multicolumn{1}{|c|}{vìt} \\
			\hline
			10000 & 8 326 164B & 36 244 240B & 92.65\% & 91.97\% & 43.02\% & 40.64\% \\ 
			20000 & 1 3706 360B & 57 072 452B & 88.37\% & 92.78\% & 8.07\% & 45.28\% \\ 
			30000 & 18 953 540B & 76 697 368B & 88.71\% & 93.51\% & 7.99\% & 48.41\% \\ 
			40000 & 23 583 752B & 941 901 36B & 90.12\% & 93.61\% & 15.69\% & 49.06\% \\ 
			50000 & 28 602 144B & 109 663 924B & 89.45\% & 93.83\% & 6.85\% & 50.26\% \\ 
			60000 & 34 118 604B & 123 654 348B & 89.63\% & 94.04\% & 8.05\% & 51.09\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Srovnání mezi L1 a L2 pøi konstantním poètu iterací (data)}
		\label{tab:L1L2KonstIterEval}
	\end{center}
\end{table}

\pagebreak

\subsection{Pøi konstantním delta a regularizaci L1}

\subsubsection*{Pøíprava}
Nejdøíve jsem se rozhodl uskuteènit skupinu testù se sni¾ující se hodnotou delta od 0.1 po 0.0001, po spu¹tìní testù a dokonèení pouze dvou z nich, kdy od hodnoty 0.001 ji¾ byla podmínka ukonèení  pøíli¹ nároèná a proces testování by trval øádovì mìsíce, jsem se rozhodl od tohoto testu upustit. Zároveò hodnota 0.1 poskytovala kvalitní výsledky v rozumném èase a poèet iterací okolo 50, co¾ nám nabízí rozumné srovnání s pøedchozím zpùsobem testování.

\subsubsection*{Konstantní podmínky}
\emph{Algoritmus:} L-BFGS\\
\emph{Delta:} 0.1\\
\emph{Èásti znaèky:} 1 -- 5 a 8 -- 9\\
\emph{Poèet vìt pøi testování úspì¹nosti: }7000\\
\emph{Regularizace:} L1

\subsubsection*{Vyhodnocení}
V tomto testu se opìt ve velkém projevila chyba pøi regularizaci L1, kdy 2 z pìti výsledkù mají neúmìrnou úspì¹nost.  Ze zbylých tøí testù lze pak vidìt existující stoupající tendenci v úspì¹nosti dle jednotlivých slov, výsledek je ale z dùvodu chyb velmi neprùkazný. 

\begin{table}[bp]
	\begin{center}
		\begin{tabular}{|c|r|r|r|r|r|r|r|r|}

			\hline
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Doba} &
			\multicolumn{1}{|c|}{Velikost} &
			\multicolumn{1}{|c|}{Úvodní} &
			\multicolumn{1}{|c|}{Koneèný} &
			\multicolumn{1}{|c|}{Úsp.} &
			\multicolumn{1}{|c|}{Úsp.} \\

			\multicolumn{1}{|c|}{vìt} &
			\multicolumn{1}{|c|}{iterací} &
			\multicolumn{1}{|c|}{trénování} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{poèet rysù} &
			\multicolumn{1}{|c|}{poèet rysù} &
			\multicolumn{1}{|c|}{slov} &
			\multicolumn{1}{|c|}{vìt} \\
			\hline
			10000 & 47 & 19h 20m & 8722904B & 905326 & 209912 & 92.61\% & 43.12\% \\ 
			20000 & 50 & 58h 54m & 13706360B & 1464587 & 334939 & 88.37\% & 8.07\% \\ 
			30000 & 51 & 107h 55m & 19722532B & 2002356 & 488244 & 93.50\% & 46.25\% \\ 
			40000 & 55 & 155h 57m & 22254268B & 2488724 & 551872 & 89.67\% & 11.26\% \\ 
			50000 & 53 & 110h 58m & 2777452B & 2924981 & 696340 & 89.42\% & 6.79\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Výsledky testù pøi regularizaci L1 a konstantním poètu iterací}
		\label{tab:RegL1KonstDel}
	\end{center}
\end{table}

\subsection{Pøi konstantním delta a regularizaci L1}

\subsection{Pøi konstantním delta - srovnání mezi L1 a L2} 

\pagebreak

\subsection{S vyu¾itím algoritmu SGD}
\subsubsection*{Pøíprava}
Algoritmus Stochastic Gradient Descent (více informací v podkapitole~\ref{sec:sgd}) bohu¾el vìt¹inu èasu projektu stál mimo mùj zájem. Pøi jeho vyzkou¹ení jsem v¹ak byl pøekvapen jeho velmi kvalitními výsledky a rychlým zpracováním. Pouze jsem tedy zpracoval nìkolik rychlých testù, abych zjistil mo¾nosti jeho vyu¾ití. Nejdøíve jsem spustil tøi testy pro zji¹tìní vhodné hodnoty delta a poté 5 testù s poètem vstupních vìt pohybujícím se mezi 10 a 50 tisíci vzorkù, abych mohl jeho výsledky porovnat se zpracováním za pomoci algoritmu L-BFGS. Pou¾itý program CRFSuite podporuje v pøípadì pou¾ití tohoto algoritmu pouze regularizaci L2 a není tedy nutno zrcadlit testy na jakékoliv jiné varianty.

\subsubsection*{Konstantní podmínky:}
\emph{Algoritmus:} SGD\\
\emph{Èásti znaèky:} 1 -- 5 a 8 -- 9\\
\emph{Poèet vìt pøi testování úspì¹nosti: }7000\\
\emph{Regularizace:} L2

\subsubsection*{Vyhodnocení}
Jako pøi v¹ech ostatních testech, i v tomto pøípadì se zvy¹ováním pøesnosti a poètu vstupních vzorkù se plynule zvy¹uje i úspì¹nost. Oproti ostatním testovaným variantám je v¹ak tato mnohem rychlej¹í a poskytuje kvalitnìj¹í výsledky, kdy pøi 50 000 vìtách se dostáváme a¾ na 94,31\% a pøi vìt¹ím poètu vstupních prvkù, nebo v kombinaci s vy¹¹í pøesností by tak nejspí¹e byla pokoøena hranice 95\%. Pøi porovnání s hodnotami získanými testováním s algoritmem L-BFGS je tento a¾ 3krát rychlej¹í a úspì¹nost je pøitom vy¹¹í o 0.5\% (pøi 30 000 vstupních vìtách a deltì 0.1). 

\begin{table}[bp]
	\begin{center}
		\begin{tabular}{|c|r|r|r|r|r|r|r|r|}

			\hline
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Doba} &
			\multicolumn{1}{|c|}{Velikost} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Úsp.} &
			\multicolumn{1}{|c|}{Úsp.} \\

			\multicolumn{1}{|c|}{vìt} &
			\multicolumn{1}{|c|}{iterací} &
			\multicolumn{1}{|c|}{trénování} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{rysù} &
			\multicolumn{1}{|c|}{slov} &
			\multicolumn{1}{|c|}{vìt} \\
			\hline
			10000 & 27 & 8h 37m & 36244240B & 905326 & 92.34\% & 42.85\% \\
			20000 & 29 & 21h 40m & 57072452B & 1464587 & 93.33\% & 48.67\% \\ 
			30000 & 35 & 30h 13m & 76696816B & 2002349 & 93.96\% & 51.60\% \\ 
			40000 & 36 & 41h 25m & 94190136B & 2488724 & 94.31\% & 53.45\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Výsledky testù pøi algoritmu SGD, regularizaci L2 a konstantním delta}
		\label{tab:SGDRegL2KonstDel}
	\end{center}
\end{table}

\pagebreak

\section{Porovnávání úspì¹nosti pøi vynechání urèitých pravidel rysù}
Po zhodnocení pøedchozích testù jsem pøipravil pravidla pro nejdùle¾itìj¹í èást, kterou je testování úspì¹nosti pøi vynechání urèitých rysù (zji¹»ování váhy rysu na koneèný výsledek). Pro tuto èást jsem se nakonec rozhodl vyu¾ít radìji nemìnnou konstantu delta, která poskytne algoritmu vìt¹í volnost v pøípadì zmìn zpùsobených vynecháním jednotlivých rysù. V tomto kroku bude provedeno testování pøi postupném vynechávání v¹ech jednotlivých rysù a poté bude analyzován jejich pøínos pro úspì¹nost urèení. Do testování je zahrnut i test bez vynechaného rysu, který bude slou¾it jako referenèní a podle jeho hodnot poté budou urèeny kladné a záporné vysledky. Nejménì výhodné pøíznaky poté budou vypu¹tìny a celý model bude otestován bez nich. Získaný výsledek poté bude porovnán s pùvodní hodnotou a dle tohoto výsledku bude urèena úspì¹nost tohoto pøístupu.

\subsection{Pøi regularizaci L1}
\subsubsection*{Pøíprava}
Rozhodoval jsem se, zda, s ohledem na anomálie, produkované trénováním s vyu¾ítím regularizace L1, vytvoøit testy i s tímto nastavením, nebo zda radìji pøejít rovnou na bezproblémovou regularizaci L2. Z dùvodu kompletnosti jsem se v¹ak rozhodl tyto testy nevynechávat a zahrnout je do práce, pøinejmen¹ím pro porovnání výsledkù.

\subsubsection*{Konstantní podmínky}
\emph{Algoritmus:} L-BFGS\\
\emph{Delta:} 0.1\\
\emph{Èásti znaèky:} 1 -- 5 a 8 -- 9\\
\emph{Poèet vìt pøi testování úspì¹nosti: }7000\\
\emph{Regularizace:} L1

\subsubsection*{Vyhodnocení}
Pøi pohledu do tabulky~\ref{tab:FeaturesL1} lze spatøit, ¾e referenèní test bohu¾el produkuje abnormální (chybné) výsledky a tudí¾ tím komplikuje celý proces urèení hodnoty jednotlivých rysù. Pøi zanedbání chybných testù lze vidìt, ¾e úspì¹nost urèení jednotlivých slov se pohybuje v rámci jednoho procenta a ¾ádný z rysù tedy nemá na koneèný výsledek rozhodující vliv. Nìkteré z rysù v¹ak mají na výsledek místo pozitivního, vliv negativní a tím pádem bude vhodné je pøi testování vypustit. 

Pro lep¹í srovnání byla vytvoøena tabulka~\ref{tab:SrovnaniL1}, která zachycuje rozdíl mezi úspì¹ností pøi vynechání daného rysu a referenèní hodnotou. Ta je zapsána pod hlavièkou tabulky a ve vìt¹inì pøípadù je pou¾ita výsledná hodnota referenèního výsledku bez vynechaných pravidel. Vyjímku tvoøí poslední sloupec, kde je pou¾ito èíslo 89, které nejlépe oddìluje u¾iteèné pøíznaky od tìch neu¾iteèných. Jedná se v¹ak pouze o odhad a proto je mo¾né, ¾e neu¾iteèných rysù je ve skuteènosti mnohem více, èi ménì. Pro vìt¹í názornost byl do tabulky pøidán sloupec s popisem jednotlivých pravidel generování rysù.

Z tabulky lze vyèíst nìkolik údajù. Jednak Poèet rysù se zvy¹uje se vzdáleností od aktuálního prvku, co¾ je logické, kdy¾ se zamyslíme nad zpùsobem zpracování programem. Ka¾dá unikátní vlastnost je vstahována k souèasnému prvku. Pøi urèení aktuálního prvku tedy generujeme pouze 1 unikátní vlastnost, v kombinaci s prvky le¾ícími v sousedství v¹ak musíme v¾dy ulo¾it kombinaci daného prvku s prvkem aktuálním.

Dále se na rysy mù¾eme podívat z pohledu pamì»ové nároènosti, kde nìkolika sty tisíci unikátními vlastnostmi jasnì dominují mo¾ná lemmata a slovní tvary, které se tak stávají kandidátem na pøípadné vypu¹tìní z modelu v pøípadì potøeby sní¾ení pamì»ové nároènosti trénování (za pøedpokladu, ¾e by tím nebyla výraznì naru¹ena úspì¹nost trénování). To také dokazuje výsledná velikost modelu, kde k nejvìt¹ímu sní¾ení do¹lo u mo¾ných lemmat a slovního tvaru na aktuální pozici a to pøes 3MB. Naproti tomu pøi vynechání spoleèné znaèky na aktuální pozici se model je¹tì o 3MB zvìt¹il.

Tuènì vyznaèené záznamy v tabulce jsou poté ty, u kterých se projevila anomálie regularizace L1 - nemají tedy ¾ádnou váhu pøi analýze a nebudou zaøazeny do vybírání nejménì u¾iteèných prvkù. Pro detailnìj¹í a správnìj¹í zpracování by bylo nutno provést celý test je¹tì jednou na jiném vzorku dat a poté pracovat pouze se správnou hodnotou, resp. s prùmìrem v pøípadì nevyskytující se chyby v obou pøípadech pro dané pravidlo. Na toto zpracování se v¹ak nedostávalo èasu a bylo nutno jej vynechat a pøesunout se k dal¹ím testùm, které mohou pøinést kvalitnìj¹í a cennìj¹í výsledky.

\begin{table}
	\begin{center}
		\begin{tabular}{|c|c|r|r|r|r|r|r|r|}

			\hline
			\multicolumn{1}{|c|}{Vyn.} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Doba} &
			\multicolumn{1}{|c|}{Velikost} &
			\multicolumn{1}{|c|}{Úvodní} &
			\multicolumn{1}{|c|}{Koneèný} &
			\multicolumn{1}{|c|}{Úsp.} &
			\multicolumn{1}{|c|}{Úsp.} \\

			\multicolumn{1}{|c|}{rys} &
			\multicolumn{1}{|c|}{iterací} &
			\multicolumn{1}{|c|}{trénování} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{poèet rysù} &
			\multicolumn{1}{|c|}{poèet rysù} &
			\multicolumn{1}{|c|}{slov} &
			\multicolumn{1}{|c|}{vìt} \\
			\hline
			- & 51 & 56h 53m & 19722532B & 2002356 & 488244 & 93.50\% & 46.25\% \\ 
			\hline
			U00 & 52 & 66h 26m & 20448468B & 1795523 & 517260 & 88.94\% & 8.54\% \\ 
			U01 & 53 & 54h 50m & 17981732B & 1820650 & 448183 & 94.15\% & 51.47\% \\ 
			U02 & 51 & 87h 46m & 16350192B & 1908841 & 415861 & 92.30\% & 35.52\% \\ 
			U03 & 54 & 70h 7m & 16607456B & 1827303 & 414097 & 88.98\% & 8.16\% \\ 
			U04 & 52 & 83h 49m & 16794864B & 1797529 & 417891 & 89.26\% & 10.58\% \\ 
			U10 & 52 & 75h 0m & 17564028B & 1973324 & 427379 & 94.02\% & 50.21\% \\ 
			U11 & 52 & 82h 55m & 19037288B & 1982074 & 549159 & 88.95\% & 8.37\% \\ 
			U12 & 55 & 77h 2m & 23358588B & 2000160 & 549160 & 91.75\% & 38.07\% \\ 
			U13 & 52 & 113h 12m & 17389268B & 1982580 & 426650 & 88.91\% & 7.67\% \\ 
			U14 & 52 & 58h 7m & 17847076B & 1973946 & 434700 & 88.93\% & 8.03\% \\ 
			U20 & 50 & 83h 45m & 18678928B & 1836466 & 464943 & 88.89\% & 8.59\% \\ 
			U21 & 52 & 77h 52m & 17532072B & 1859057 & 434576 & 93.36\% & 44.68\% \\ 
			U22 & 53 & 87h 11m & 16573736B & 1919326 & 419928 & 88.95\% & 7.81\% \\ 
			U23 & 55 & 52h 54m & 16751732B & 1851001 & 413535 & 89.10\% & 8.59\% \\ 
			U24 & 52 & 83h 25m & 17933572B & 1828280 & 446111 & 88.99\% & 8.31\% \\ 
			U30 & 50 & 50h 15m & 19175560B & 1958718 & 466492 & 89.08\% & 8.83\% \\ 
			U31 & 51 & 121h 18m & 19211260B & 1969486 & 469025 & 88.90\% & 8.26\% \\ 
			U32 & 53 & 82h 12m & 19290324B & 1995508 & 474503 & 88.82\% & 8.00\% \\ 
			U33 & 51 & 78h 14m & 17678220B & 1969100 & 431720 & 89.37\% & 11.19\% \\ 
			U34 & 51 & 103h 53m & 19382824B & 1959411 & 475058 & 89.01\% & 8.29\% \\ 
			U40 & 52 & 86h 0m & 19246347B & 1998814 & 449381 & 88.97\% & 7.78\% \\ 
			U41 & 53 & 104h 4m & 19012256B & 1969647 & 463998 & 89.06\% & 8.41\% \\ 
			U42 & 53 & 77h 5m & 18186320B & 1938959 & 444168 & 88.99\% & 8.23\% \\ 
			U43 & 54 & 120h 38m & 18580128B & 1999796 & 455661 & 88.88\% & 8.37\% \\ 
			U50 & 51 & 80h 57m & 17576144B & 2000853 & 431772 & 88.96\% & 8.04\% \\ 
			U51 & 53 & 52h 39m & 17419752B & 1983793 & 424259 & 92.61\% & 37.42\% \\ 
			U52 & 52 & 95h 39m & 18321732B & 1998814 & 449381 & 88.97\% & 7.78\% \\ 
			U53 & 53 & 71h 45m & 18361820B & 1992254 & 450316 & 88.72\% & 8.16\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Výsledky testù vynechání pøíznakù pøi regularizaci L1 a konstantním delta}
		\label{tab:FeaturesL1}
	\end{center}
\end{table}

\begin{table}
	\begin{center}
		\begin{tabular}{|c|l|r|r|r|r|r|}
			\hline
			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{Popis} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Zm. kon.} &
			\multicolumn{1}{|c|}{Zm. vel.} &
			\multicolumn{1}{|c|}{Zm. úsp.} &
			\multicolumn{1}{|c|}{Zm. úsp.} \\

			\multicolumn{1}{|c|}{ID} &
			\multicolumn{1}{|c|}{pravidla} &
			\multicolumn{1}{|c|}{rysù} &
			\multicolumn{1}{|c|}{poè. rysù} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{slov} &
			\multicolumn{1}{|c|}{slov} \\

			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{(488244)} &
			\multicolumn{1}{|c|}{(19722532B)} &
			\multicolumn{1}{|c|}{(93.50\%)} &
			\multicolumn{1}{|c|}{(89.00\%)} \\
			\hline
			U00 & Slovní tvar [-2] & 206833 & 29016 &  725 936B & -4.56\% & -0.06\% \\ 
			U01 & Slovní tvar [-1] & \textbf{181706} & \textbf{-40061} & \textbf{-1 740 800B} & \textbf{0.65\%} & \textbf{5.15\%} \\ 
			U02 & Slovní tvar [0] & \textbf{93515} & \textbf{-72383} & \textbf{-3 372 340B} & \textbf{-1.20\%} & \textbf{3.30\%} \\ 
			U03 & Slovní tvar [+1] & 175053 & -74147 & -3 115 076B & -4.52\% & -0.02\% \\ 
			U04 & Slovní tvar [+2] & 204827 & -70353 & -2 927 668B & -4.24\% & 0.26\% \\ 
			U10 & Spol. znaèka [-2] & \textbf{29032} & \textbf{-60865} & \textbf{-2 158 504B} & \textbf{0.52\%} & \textbf{5.02\%} \\ 
			U11 & Spol. znaèka [-1] & 20282 & 60915 & - 685 244B & -4.55\% & -0.05\% \\ 
			U12 & Spol. znaèka [0] & \textbf{2196} & \textbf{60916} & \textbf{3 636 056B} & \textbf{-1.75\%} & \textbf{2.75\%} \\ 
			U13 & Spol. znaèka [+1] & 19776 & -61594 & -2 333 264B & -4.59\% & -0.09\% \\ 
			U14 & Spol. znaèka [+2] & 28410 & -53544 & -1 875 456B & -4.57\% & -0.07\% \\ 
			U20 & Lemma [-2] & 165890 & -23301 & -1 043 604B & -4.61\% & -0.11\% \\ 
			U21 & Lemma [-1] & \textbf{143299} & \textbf{-53668} & \textbf{-2 190 460B} & \textbf{-0.14\%} & \textbf{4.36\%} \\ 
			U22 & Lemma [0] & 83030 & -68316 & -3 148 796B & -4.55\% & -0.05\% \\ 
			U23 & Lemma [+1] & 151355 & -74709 & -2 970 800B & -4.40\% & 0.10\% \\ 
			U24 & Lemma [+2] & 174076 & -42133 & -1 788 960B & -4.51\% & -0.01\% \\ 
			U30 & Pøípona slova [-2] & 43638 & -21752 & - 546 972B & -4.42\% & 0.08\% \\ 
			U31 & Pøípona slova [-1] & 32870 & -19219 & - 511 272B & -4.60\% & -0.10\% \\ 
			U32 & Pøípona slova [0] & 6848 & -13741 & - 432 208B & -4.68\% & -0.18\% \\ 
			U33 & Pøípona slova [+1] & 33256 & -56524 & -2 044 312B & -4.13\% & 0.37\% \\ 
			U34 & Pøípona slova [+2] & 42945 & -13186 & - 339 708B & -4.49\% & 0.01\% \\ 
			U40 & První písmeno & 3542 & -38863 & - 476 185B & -4.53\% & -0.03\% \\ 
			U41 & První dvì písmena & 32709 & -24246 & - 710 276B & -4.44\% & 0.06\% \\ 
			U42 & První tøi písmena & 63397 & -44076 & -1 536 212B & -4.51\% & -0.01\% \\ 
			U43 & Poslední písmeno & 2560 & -32583 & -1 142 404B & -4.62\% & -0.12\% \\ 
			U50 & Velikost písmen & 1503 & -56472 & -2 146 388B & -4.54\% & -0.04\% \\ 
			U51 & Pozice ve vìtì & \textbf{18563} & \textbf{-63985} & \textbf{-2 302 780B} & \textbf{-0.89\%} & \textbf{3.61\%} \\ 
			U52 & Délka slova & 3542 & -38863 & -1 400 800B & -4.53\% & -0.03\% \\ 
			U53 & Zn. nejbl. slovesa & 10102 & -37928 & -19 722 532B & -4.78\% & -0.28\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Srovnání výsledkù jednotlivých pravidel s referenèními daty pøi regularizaci L1}
		\caption*{Legenda: \\
			\\
			\begin{tabularx}{\textwidth}{|l|X|}
				\hline
				Poèet rysù & Poèet rysù, vygenerovaných daným pravidlem (rozdíl mezi poètem rysù pøi vyu¾ití v¹ech pravidel a rysy pøi vynechaní pravidla daného øádku) \\			
				Zm. kon. poè. rysù & Zmìna mno¾ství rysù na konci testování, které byly ulo¾eny do modelu. Kladná hodnota znaèí pøírùstek, záporná úbytek. \\
				Zm. vel. modelu & Zmìna velikosti modelu -- rozdíl mezi referenèní a aktuální velikostí, kladná hodnota znaèí zvìt¹ení souboru, záporná pak zmen¹ení. \\
				Zm. úsp. slov & Zmìna úspì¹nosti urèení jednotlivých slov -- rozdíl mezi referenèní a aktuální úspì¹ností, kladná hodnota znaèí zlep¹ení, záporná zhor¹ení.\\
				\hline
			\end{tabularx}
		}
		\label{tab:SrovnaniL1}
	\end{center}
\end{table}

\subsubsection*{Výbìr nejménì hodnotných pravidel}
Pro výbìr nejménì vhodných pravidel pou¾ijeme tabulku~\ref{tab:SrovnaniL1}, pøesnìji její poslední sloupec, ve kterém jsou pravidla porovnávány oproti hodnotì 89\% a pomineme v¹echny tuènì zvýraznìné øádky. Vy¹¹í hodnota znamená zlep¹ení v pøípadì vynechání daného pravidla a proto budeme vyhledávat ty øádky, které mají kladnou hodnotu. 

Po pøefiltrování nám zùstalo 6 pravidel (viz. tabulka~\ref{tab:NevhodneL1}). Dle testù jsou nejménì pøínosná pravidla popisující pøíponu slova na pozici [x+1] a slovní tvar na pozici [x+2]. Pøi vynechání v¹ech tìchto pravidel ubereme ze vstupního modelu pøes pùl milionu rysù a teoreticky bychom mìli získat témìø jedno procento úspì¹nosti urèení jednotlivých slov (vzhledem k náhodnému urèení konstanty 89 je toto v¹ak velmi zavádìjící). 

Naopak nejvíce pøínosné se zdá být pravidlo popisující znaèku nejbli¾¹ího slovesa. Ostatní prvky, které se ukázaly být dùle¾ité v druhém testu, vyu¾ívajícím regularizaci L2, v tomto pøípadì jsou ovlivnìny chybou a proto je tì¾ké rozhodnout, za mají pro testování stejný pøínos.

\begin{table}
	\begin{center}
		\begin{tabular}{|c|l|r|r|r|r|}
			\hline
			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{Popis} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Zm. kon.} &
			\multicolumn{1}{|c|}{Zm. vel.} &
			\multicolumn{1}{|c|}{Zm. úsp.} \\

			\multicolumn{1}{|c|}{ID} &
			\multicolumn{1}{|c|}{pravidla} &
			\multicolumn{1}{|c|}{rysù} &
			\multicolumn{1}{|c|}{poè. rysù} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{slov} \\

			\hline 
			U04 & Slovní tvar [+2] & 204827 & -70353 & -2 927 668B & 0.26\% \\ 
			U23 & Lemma [+1] & 151355 & -74709 & -2 970 800B & 0.10\% \\ 
			U30 & Pøípona slova [-2] & 43638 & -21752 & - 546 972B & 0.08\% \\ 
			U33 & Pøípona slova [+1] & 33256 & -56524 & -2 044 312B & 0.37\% \\ 
			U34 & Pøípona slova [+2] & 42945 & -13186 & - 339 708B & 0.01\% \\ 
			U41 & První dvì písmena & 32709 & -24246 & - 710 276B & 0.06\% \\ 
			\hline
			    & Celkem & 508730 & -260770 & -9 539 736B & 0.88\% \\
			\hline
			    & Teoretický výsledek & 1493626 & 227474 & 10 182 796B & 89.88\% \\
			\hline
		\end{tabular}
		\captionof{table}{Nejménì vhodná pravidla generování rysù pøi regularizaci L1 (s nezápornou hodnotou)}
		\label{tab:NevhodneL1}
	\end{center}
\end{table}

\pagebreak

\subsection{Pøi regularizaci L2}

\subsubsection*{Pøíprava}
Pøi tomto testu byla vyu¾ita stejná pravidla, jako pøi tom pøedchozím - budou tedy postupnì spou¹tìny testy a po jednom budou vypou¹tìna v¹echna pravidla pro generování rysù. Výsledky budou porovnány s referenèními hodnotami, tvoøenými výsledkem se v¹emi pravidly a poté bude spu¹tìno nìkolik testù, vynechávajících nejménì u¾iteèná pravidla.

\subsubsection*{Konstantní podmínky}
\emph{Algoritmus:} L-BFGS\\
\emph{Delta:} 0.1\\
\emph{Èásti znaèky:} 1 -- 5 a 8 -- 9\\
\emph{Poèet vìt pøi testování úspì¹nosti: }7000\\
\emph{Regularizace:} L2

\subsubsection*{Vyhodnocení}
Pøi zobrazení výsledkù v tabulce~\ref{tab:FeaturesL2} jsem se rozhodl kompletnì vynechat zobrazení poètu pøíznakù, nebo» je závislé pouze na daném rysu a kvùli vyu¾ití regularizace L2 nemìnné. V¹echny hodnoty jsou tedy ji¾ popsány v tabulkách~\ref{tab:FeaturesL1}~a~\ref{tab:SrovnaniL1}.

Pøi pohledu na výsledky, obzvlá¹tì ty zachycené v tabulce~\ref{tab:SrovnaniL2}, jde vidìt, ¾e jednotlivá pravidla mají na výsledek testu mnohem vìt¹í vliv, ne¾ v pøede¹lém pøípadì. Pøi vynechání nìkterých pravidel úspì¹nost klesá a¾ k hranici 90\% a naopak u jiných stoupá a¾ témìø k 94\%. Co je v¹ak pøekvapivé, ¾e pøi vynechání vìt¹iny pravidel se koneèná úspì¹nost zvý¹ila. Mohlo by se tedy zdát, ¾e celý model by bylo nejlep¹í otestovat s mno¾inou pouze 8 pravidel, jejich¾ vypu¹tìní mìlo na výsledek záporný vliv, bychom mìli získat nejlep¹í výsledky. 

Co se týèe pamì»ové nároènosti, je v tomto pøípadì model povìt¹inou témìø stejný, jako bez vynechání jakéhokoliv pravidla - zmìna se pohybuje do 10\%. To je samozøejmì zpùsobené konstantním poètem výstupních rysù a pokud bychom chtìli sni¾ovat velikost výstupního modelu, byli bychom nuceni odebírat ze zpracování dal¹í pravidla. Nejvíce místa poté opìt zabírají stejná pravidla jako v pøedchozí kapitole tj. Slovní tvary a mo¾ná lemmata.

\subsubsection*{Výbìr nejménì hodnotných pravidel}
Nejsilnìj¹í vliv na kvalitu modelu má podle tabulky~\ref{tab:VhodneL2} pravidlo urèující spoleèné sloupce znaèky na aktuální pozici, následované znaèkou nejbli¾¹ího slovesa a slovním tvarem pøedcházejícího prvku, kde po vynechání kteréhokoliv ze zmínìných pravidel klesá úspì¹nost o více ne¾ 2 procenta. Poté následuje výrazný propad a¾ k hranici 0.5\% a zbylým pravidlùm.

Naproti tomu, jak je vyobrazeno v tabulce~\ref{tab:NevhodneL2}, nejhùøe dopadlo pravidlo se spoleènoou znaèkou následujícího prvku, oba nadcházející slovní tvary (na pozici +1 a +2) a v¹echna mo¾ná lemmata na pozici +1, kdy po vynechání tìchto prvkù stoupla koneèná úspì¹nost o více ne¾ jedno procento. Tato pravidla jsou následována dal¹ími 8mi pravidly se zmìnou vìt¹í ne¾ pùl procenta a zbylými pravidly klesajícími a¾ k nule. Z tabulky lze také vyèíst, ¾e teoretický zisk, pøi vynechání v¹ech nevhodných znaèek, je témìø 12 procent, co¾ je samozøejmì hloupost, nebo» bychom poté dosáhli více ne¾ stoprocentní úspì¹nosti, bude v¹ak zajímavé pozorovat, jaký rozdíl pøinese vynechání jednotlivých skupin pravidel.

Skupiny pro vynechání v nadcházejících testech jsou utvoøeny v¾dy pøidáním dvou dal¹ích, nejménì vhodných rysù do testování. Budeme tedy pracovat s tøemi/pìti/sedmi a devíti nejhor¹ími rysy a porovnáme jejich výsledky. %TODO pøepsat

\begin{table}
	\begin{center}
		\begin{tabular}{|c|c|r|r|r|r|r|r|r|}

			\hline
			\multicolumn{1}{|c|}{Vyn.} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Doba} &
			\multicolumn{1}{|c|}{Velikost} &
			\multicolumn{1}{|c|}{Úsp.} &
			\multicolumn{1}{|c|}{Úsp.} \\

			\multicolumn{1}{|c|}{rys} &
			\multicolumn{1}{|c|}{iterací} &
			\multicolumn{1}{|c|}{trénování} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{slov} &
			\multicolumn{1}{|c|}{vìt} \\
			\hline
			- & 85 & 68h 18m & 76 697 368B & 92.17\% & 37.81\% \\ 
			\hline
			U00 & 92 & 97h 42m & 68 334 112B & 92.06\% & 37.18\% \\ 
			U01 & 89 & 94h 11m & 68 711 220B & 90.06\% & 23.14\% \\ 
			U02 & 89 & 111h 48m & 70 778 636B & 92.81\% & 43.13\% \\ 
			U03 & 93 & 110h 56m & 69 117 464B & 93.21\% & 45.61\% \\ 
			U04 & 89 & 74h 25m & 69 117 464B & 93.34\% & 46.75\% \\ 
			U10 & 87 & 74h 2m & 75 978 768B & 92.25\% & 38.21\% \\ 
			U11 & 87 & 78h 34m & 76 188 624B & 91.88\% & 36.02\% \\ 
			U12 & 106 & 109h 0m & 76 622 728B & 88.41\% & 21.38\% \\ 
			U13 & 85 & 117h 7m & 76 200 816B & 93.54\% & 48.15\% \\ 
			U14 & 84 & 132h 24m & 75 993 648B & 92.83\% & 42.47\% \\ 
			U20 & 90 & 88h 28m & 70 713 648B & 92.65\% & 41.10\% \\ 
			U21 & 86 & 103h 12m & 71 135 652B & 92.64\% & 41.96\% \\ 
			U22 & 87 & 145h 2m & 72 557 072B & 92.52\% & 40.71\% \\ 
			U23 & 86 & 0h 0m & 70 987 512B & 93.19\% & 45.22\% \\ 
			U24 & 85 & 0h 0m & 70 507 312B & 92.67\% & 40.78\% \\ 
			U30 & 82 & 137h 37m & 75 593 472B & 92.74\% & 41.84\% \\ 
			U31 & 84 & 84h 49m & 75 850 056B & 92.80\% & 42.09\% \\ 
			U32 & 87 & 71h 9m & 76 473 724B & 91.65\% & 32.23\% \\ 
			U33 & 85 & 110h 53m & 75 841 520B & 93.03\% & 44.06\% \\ 
			U34 & 82 & 85h 21m & 75 610 748B & 91.60\% & 32.17\% \\ 
			U40 & 85 & 81h 29m & 76 496 988B & 92.07\% & 36.79\% \\ 
			U41 & 86 & 94h 15m & 75 831 124B & 92.40\% & 39.32\% \\ 
			U42 & 87 & 69h 2m & 74 748 916B & 92.88\% & 43.22\% \\ 
			U43 & 85 & 154h 52m & 75 527 288B & 92.38\% & 39.52\% \\ 
			U50 &  &  &  &  &  \\ 
			U51 & 89 & 97h 36m & 76 243 740B & 92.26\% & 38.77\% \\ 
			U52 & 81 & 82h 28m & 76 611 296B & 93.06\% & 44.39\% \\ 
			U53 & 85 & 71h 54m & 76 452 768B & 90.04\% & 24.93\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Výsledky testù vynechání pøíznakù pøi regularizaci L2 a konstantním delta}
		\label{tab:FeaturesL2}		
	\end{center}
\end{table}
%TODO DOplnit hodnoty U50
\begin{table}
	\begin{center}
		\begin{tabular}{|c|l|r|r|r|r|r|}
			\hline
			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{Popis} &
			\multicolumn{1}{|c|}{Zm. vel.} &
			\multicolumn{1}{|c|}{Zm. úsp.} \\

			\multicolumn{1}{|c|}{ID} &
			\multicolumn{1}{|c|}{pravidla} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{slov} \\

			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{(76 697 368B)} &
			\multicolumn{1}{|c|}{(92.17\%)} \\
			\hline
			U00 & Slovní tvar [-2] & -8 363 256B & -0.11\% \\ 
			U01 & Slovní tvar [-1] & -7 986 148B & -2.11\% \\ 
			U02 & Slovní tvar [0] & -5 918 732B & 0.64\% \\ 
			U03 & Slovní tvar [+1] & -7 579 904B & 1.04\% \\ 
			U04 & Slovní tvar [+2] & -7 579 904B & 1.17\% \\ 
			U10 & Spoleèná znaèka [-2] & - 718 600B & 0.08\% \\ 
			U11 & Spoleèná znaèka [-1] & - 508 744B & -0.29\% \\ 
			U12 & Spoleèná znaèka [0] & - 74 640B & -3.76\% \\ 
			U13 & Spoleèná znaèka [+1] & - 496 552B & 1.37\% \\ 
			U14 & Spoleèná znaèka [+2] & - 703 720B & 0.66\% \\ 
			U20 & Mo¾ná lemmata [-2] & -5 983 720B & 0.48\% \\ 
			U21 & Mo¾ná lemmata [-1] & -5 561 716B & 0.47\% \\ 
			U22 & Mo¾ná lemmata [0] & -4 140 296B & 0.35\% \\ 
			U23 & Mo¾ná lemmata [+1] & -5 709 856B & 1.02\% \\ 
			U24 & Mo¾ná lemmata [+2] & -6 190 056B & 0.50\% \\ 
			U30 & Pøípona slova [-2] & -1 103 896B & 0.57\% \\ 
			U31 & Pøípona slova [-1] & - 847 312B & 0.63\% \\ 
			U32 & Pøípona slova [0] & - 223 644B & -0.52\% \\ 
			U33 & Pøípona slova [+1] & - 855 848B & 0.86\% \\ 
			U34 & Pøípona slova [+2] & -1 086 620B & -0.57\% \\ 
			U40 & První písmeno & - 200 380B & -0.10\% \\ 
			U41 & První dvì písmena & - 866 244B & 0.23\% \\ 
			U42 & První tøi písmena & -1 948 452B & 0.71\% \\ 
			U43 & Poslední písmeno & -1 170 080B & 0.21\% \\ 
			U50 & Velikost písmen & -76 697 368B & -92.17\% \\ 
			U51 & Pozice ve vìtì & - 453 628B & 0.09\% \\ 
			U52 & Délka slova & - 86 072B & 0.89\% \\ 
			U53 & Znaèka nejbl. slovesa & - 244 600B & -2.13\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Srovnání výsledkù jednotlivých pravidel s referenèními daty pøi regularizaci L2}
		\caption*{Legenda: \\
			\\
			\begin{tabularx}{\textwidth}{|l|X|}
				\hline
				Zm. vel. modelu & Zmìna velikosti modelu -- rozdíl mezi referenèní a aktuální velikostí, kladná hodnota znaèí zvìt¹ení souboru, záporná pak zmen¹ení. \\
				Zm. úsp. slov & Zmìna úspì¹nosti urèení jednotlivých slov -- rozdíl mezi referenèní a aktuální úspì¹ností, kladná hodnota znaèí zlep¹ení, záporná zhor¹ení.\\
				\hline
			\end{tabularx}
		}
		\label{tab:SrovnaniL2}
	\end{center}
\end{table}

\begin{table}
	\begin{center}
		\begin{tabular}{|c|l|r|r|r|r|}
			\hline
			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{Popis} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Zm. vel.} &
			\multicolumn{1}{|c|}{Zm. úsp.} \\

			\multicolumn{1}{|c|}{ID} &
			\multicolumn{1}{|c|}{pravidla} &
			\multicolumn{1}{|c|}{rysù} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{slov} \\

			\hline 
			U12 & Spoleèná znaèka [0] &  2 196 & - 74 640B & -3.76\% \\ 
			U53 & Znaèka nejbl. slovesa &  10 102 & - 244 600B & -2.13\% \\ 
			U01 & Slovní tvar [-1] &  181 706 & -7 986 148B & -2.11\% \\ 
			U34 & Pøípona slova [+2] &  42 945 & -1 086 620B & -0.57\% \\ 
			U32 & Pøípona slova [0] &  6 848 & - 223 644B & -0.52\% \\ 
			U11 & Spoleèná znaèka [-1] &  20 282 & - 508 744B & -0.29\% \\ 
			U00 & Slovní tvar [-2] &  206 833 & -8 363 256B & -0.11\% \\ 
			U40 & První písmeno &  8 169 & - 200 380B & -0.10\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Pravidla s kladným efektem, seøazená podle zmìny ú¹pì¹nosti}
		\label{tab:VhodneL2}
	\end{center}
\end{table}

\begin{table}
	\begin{center}
		\begin{tabular}{|c|l|r|r|r|r|}
			\hline
			\multicolumn{1}{|c|}{} &
			\multicolumn{1}{|c|}{Popis} &
			\multicolumn{1}{|c|}{Poèet} &
			\multicolumn{1}{|c|}{Zm. vel.} &
			\multicolumn{1}{|c|}{Zm. úsp.} \\

			\multicolumn{1}{|c|}{ID} &
			\multicolumn{1}{|c|}{pravidla} &
			\multicolumn{1}{|c|}{rysù} &
			\multicolumn{1}{|c|}{modelu} &
			\multicolumn{1}{|c|}{slov} \\

			\hline 
			U13 & Spoleèná znaèka [+1] &  19 776 & - 496 552B & 1.37\% \\ 
			U04 & Slovní tvar [+2] &  175 053 & -7 579 904B & 1.17\% \\ 
			U03 & Slovní tvar [+1] &   204 827 & -7 579 904B & 1.04\% \\ 
			U23 & Mo¾ná lemmata [+1] &  151 355 & -5 709 856B & 1.02\% \\ 
			U52 & Délka slova &  3 542 & - 86 072B & 0.89\% \\ 
			U33 & Pøípona slova [+1] &  33 256 & - 855 848B & 0.86\% \\ 
			U42 & První tøi písmena &  63 397 & -1 948 452B & 0.71\% \\ 
			U14 & Spoleèná znaèka [+2] &  28 410 & - 703 720B & 0.66\% \\ 
			U02 & Slovní tvar [0] &  93 515 & -5 918 732B & 0.64\% \\ 
			U31 & Pøípona slova [-1] &  32 870 & - 847 312B & 0.63\% \\ 
			U30 & Pøípona slova [-2] &  43 638 & -1 103 896B & 0.57\% \\ 
			U24 & Mo¾ná lemmata [+2] &  174 076 & -6 190 056B & 0.50\% \\ 
			U20 & Mo¾ná lemmata [-2] &  165 890 & -5 983 720B & 0.48\% \\ 
			U21 & Mo¾ná lemmata [-1] &  143 299 & -5 561 716B & 0.47\% \\ 
			U22 & Mo¾ná lemmata [0] &  83 030 & -4 140 296B & 0.35\% \\ 
			U41 & První dvì písmena &  32 709 & - 866 244B & 0.23\% \\ 
			U43 & Poslední písmeno &  46 198 & -1 170 080B & 0.21\% \\ 
			U51 & Pozice ve vìtì &  18 563 & - 453 628B & 0.09\% \\ 
			U10 & Spoleèná znaèka [-2] &  29 032 & - 718 600B & 0.08\% \\ 
			\hline
			 & Celkem & 1 512 662 & -57 914 588B & 11.97\% \\ 
			\hline
			 & Teoretický výsledek &  479 081 & 18 688 032B & 104.14\% \\ 
			\hline
		\end{tabular}
		\captionof{table}{Pravidla se záporným efektem, seøazená podle zmìny ú¹pì¹nosti}
		\label{tab:NevhodneL2}
	\end{center}
\end{table}

\pagebreak

\subsection{Srovnání mezi L1 a L2}

\section{Vyu¾ití zji¹tìných poznatkù pro zlep¹ení úspì¹nosti testování}

\subsection{Pøi regularizaci L1}

\subsection{Pøi regularizaci L2}

\subsection{Se zpracováním algoritmem SGD}
\chapter{Závìr}

%=========================================================================
